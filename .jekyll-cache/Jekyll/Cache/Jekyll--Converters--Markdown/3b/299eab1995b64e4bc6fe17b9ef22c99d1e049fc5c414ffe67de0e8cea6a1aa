I"*©<h2 id="0-ì´ë²ˆ-ì¥ì—ì„œ-í• -ê²ƒ">0. ì´ë²ˆ ì¥ì—ì„œ í•  ê²ƒ</h2>
<ul>
  <li>ë¹…ë°ì´í„° ì•„í‚¤í…ì²˜ì˜ ì²« ë²ˆì§¸ ë ˆì´ì–´ì¸ <strong>ìˆ˜ì§‘ ì˜ì—­</strong> êµ¬ì¶•</li>
  <li>ìŠ¤ë§ˆíŠ¸ì¹´ ì‹œë®¬ë ˆì´í„°ë¡œ ë°°ì¹˜ íŒŒì¼(ìŠ¤ë§ˆíŠ¸ì¹´ ìƒíƒœ ì •ë³´)ê³¼ ì‹¤ì‹œê°„ ë¡œê·¸(ìŠ¤ë§ˆíŠ¸ì¹´ ìš´í–‰ ì •ë³´) ìƒì„±</li>
  <li>ì´ë¥¼ í”ŒëŸ¬ëª¨ê°€ ì¹´í”„ì¹´ë¡œ ìˆ˜ì§‘</li>
</ul>

<p><br /></p>

<h2 id="1-flume-ì„¤ì¹˜">1. Flume ì„¤ì¹˜</h2>
<ul>
  <li>CM í™ˆì—ì„œ [ì„œë¹„ìŠ¤ ì¶”ê°€] - [Flume] ì„ íƒ
<img src="/img/CH03/flume%20%EC%84%A4%EC%B9%98.png" alt="" /></li>
  <li>ì„œë²„ í˜¸ìŠ¤íŠ¸ <code class="language-plaintext highlighter-rouge">server02.hadoop.com</code> ì„ íƒ</li>
</ul>

<p><br /></p>

<ul>
  <li><strong>Flume Heap Memory ìˆ˜ì •</strong>
    <ul>
      <li>50Mib -&gt; <strong>100MiB</strong>
  <img src="img/CH03/flume%20heap%20memory%20%EB%B3%80%EA%B2%BD.png" alt="" /></li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="2-kafka-ì„¤ì¹˜">2. Kafka ì„¤ì¹˜</h2>
<ul>
  <li>
    <p>CM í™ˆì—ì„œ [ì„œë¹„ìŠ¤ ì¶”ê°€] - [Kafka] ì„ íƒ
<img src="img/CH03/kafka%20%EC%84%A4%EC%B9%98.png" alt="" /></p>
  </li>
  <li>
    <p>ì„œë²„ í˜¸ìŠ¤íŠ¸ <code class="language-plaintext highlighter-rouge">server02.hadoop.com</code> ì„ íƒ</p>
  </li>
</ul>

<p><br /></p>

<ul>
  <li><strong>ì¹´í”„ì¹´ì— ì €ì¥ë  ë©”ì‹œì§€ ë³´ê´€ ê¸°ê°„ ì§§ê²Œ ì¡°ì •</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">Data Retention Time</code> 7ì¼ -&gt; <strong>10ë¶„</strong>
  <img src="img/CH03/kafka%20data%20retention%20time%20%EB%B3%80%EA%B2%BD.png" alt="" /></li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="3-í”ŒëŸ¼-ìˆ˜ì§‘-ê¸°ëŠ¥-êµ¬í˜„">3. í”ŒëŸ¼ ìˆ˜ì§‘ ê¸°ëŠ¥ êµ¬í˜„</h2>
<ul>
  <li>í”ŒëŸ¼ì—ì„œ 2ê°œì˜ ì—ì´ì „íŠ¸ êµ¬í˜„
    <ul>
      <li>ìŠ¤ë§ˆíŠ¸ì¹´ ìƒíƒœì •ë³´ ìˆ˜ì§‘í•˜ëŠ” <code class="language-plaintext highlighter-rouge">SmartCarInfo Agent</code></li>
      <li>ìš´ì „ìì˜ ìš´í–‰ì •ë³´ ìˆ˜ì§‘í•˜ëŠ” <code class="language-plaintext highlighter-rouge">DriverCarInfo Agent</code></li>
    </ul>
  </li>
  <li>ì—ì´ì „íŠ¸ ìƒì„±
    <ul>
      <li>í”ŒëŸ¼ì´ ì¸ì‹í•  ìˆ˜ ìˆëŠ” íŠ¹ì • ë””ë ‰í„°ë¦¬ì— <code class="language-plaintext highlighter-rouge">{Agent ê³ ìœ  ì´ë¦„}.conf</code> íŒŒì¼ ìƒì„±</li>
      <li>íŒŒì¼ëŸ¿ í”„ë¡œì íŠ¸ì—ì„œëŠ” CMì—ì„œ ì œê³µí•˜ëŠ” í”ŒëŸ¼ êµ¬ì„± ì •ë³´ ì„¤ì •ì„ í†µí•´ ì—ì´ì „íŠ¸ í¸ë¦¬í•˜ê²Œ ìƒì„± ê°€ëŠ¥</li>
    </ul>
  </li>
</ul>

<h3 id="1-smartcar-ì—ì´ì „íŠ¸-ìƒì„±">1) SmartCar ì—ì´ì „íŠ¸ ìƒì„±</h3>
<ul>
  <li>CM í™ˆ [Flume] - [êµ¬ì„±]</li>
  <li><code class="language-plaintext highlighter-rouge">êµ¬ì„± íŒŒì¼</code> í•­ëª© ìˆ˜ì •</li>
</ul>

<p><img src="img/CH03/flume%20agent%20ìƒì„±.png" alt="" /></p>

<p><br /></p>

<ul>
  <li>Agent ì´ë¦„: <code class="language-plaintext highlighter-rouge">SmartCar_Agent</code></li>
  <li>êµ¬ì„± íŒŒì¼</li>
</ul>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#1
</span><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>  = <span class="n">SmartCarInfo_SpoolSource</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span> = <span class="n">SmartCarInfo_Channel</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>    = <span class="n">SmartCarInfo_LoggerSink</span> 

<span class="c">#2
</span><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">type</span> = <span class="n">spooldir</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">spoolDir</span> = /<span class="n">home</span>/<span class="n">pilot</span>-<span class="n">pjt</span>/<span class="n">working</span>/<span class="n">car</span>-<span class="n">batch</span>-<span class="n">log</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">deletePolicy</span> = <span class="n">immediate</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">batchSize</span> = <span class="m">1000</span>

<span class="c">#3
</span><span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">type</span> = <span class="n">memory</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">capacity</span>  = <span class="m">100000</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">transactionCapacity</span>  = <span class="m">10000</span>

<span class="c">#4
</span><span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">SmartCarInfo_LoggerSink</span>.<span class="n">type</span> = <span class="n">logger</span>

<span class="c">#5
</span><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">channels</span> = <span class="n">SmartCarInfo_Channel</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">SmartCarInfo_LoggerSink</span>.<span class="n">channel</span> = <span class="n">SmartCarInfo_Channel</span>
</code></pre></div></div>

<ul>
  <li>#1
    <ul>
      <li>í”ŒëŸ¼ì˜ ì—ì´ì „íŠ¸ì—ì„œ ì‚¬ìš©í•  Source, Channle, Sinkì˜ ê° ë¦¬ì†ŒìŠ¤ ë³€ìˆ˜ ì •ì˜</li>
    </ul>
  </li>
  <li>#2
    <ul>
      <li>ì—ì´ì „íŠ¸ì˜ Source ì„¤ì •</li>
      <li>#1ì—ì„œ Sourceë¡œ ì„ ì–¸í–ˆë˜ <code class="language-plaintext highlighter-rouge">SmartCarInfo_SpoolSource</code> ë³€ìˆ˜ì˜ typeì„ <code class="language-plaintext highlighter-rouge">spooldir</code>ë¡œ ì„¤ì •</li>
      <li><code class="language-plaintext highlighter-rouge">spooldir</code> : ì§€ì •í•œ íŠ¹ì • ë””ë ‰í„°ë¦¬ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ìˆë‹¤ê°€ ìƒˆë¡œìš´ íŒŒì¼ì´ ìƒì„±ë˜ë©´ ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•´ì„œ <code class="language-plaintext highlighter-rouge">batchSize</code> ì„¤ì •ê°’ë§Œí¼ ì½ì–´ì„œ #3ì˜ Channelì— ë°ì´í„° ì „ì†¡</li>
    </ul>
  </li>
  <li>#3
    <ul>
      <li>ì—ì´ì „íŠ¸ì˜ Channelë¡œì„œ <code class="language-plaintext highlighter-rouge">SmartCarInfo_Channel</code>ì˜ typeì„ <code class="language-plaintext highlighter-rouge">memory</code>ë¡œ ì„¤ì •</li>
      <li>ì±„ë„ì˜ ì¢…ë¥˜) memory / file</li>
      <li>Memory Channelì€ Sourceë¡œë¶€í„° ë°›ì€ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ ìƒì— ì¤‘ê°„ ì ì¬ -&gt; ì„±ëŠ¥ ë†’ì§€ë§Œ, ì•ˆì •ì„± ë‚®ìŒ</li>
      <li>File Channelì€ Sourceì—ì„œ ì „ì†¡í•œ ë°ì´í„°ë¥¼ ë°›ì•„ ë¡œì»¬ íŒŒì¼ì‹œìŠ¤í…œ ê²½ë¡œì¸ <code class="language-plaintext highlighter-rouge">dataDirs</code>ì— ì„ì‹œë¡œ ì €ì¥í–ˆë‹¤ê°€ Sinkì—ê²Œ ë°ì´í„° ì œê³µ -&gt; ì„±ëŠ¥ ë‚®ì§€ë§Œ, ì•ˆì •ì„± ë†’ìŒ</li>
    </ul>
  </li>
  <li>#4
    <ul>
      <li>ì—ì´ì „íŠ¸ì˜ ìµœì¢… ëª©ì ì§€</li>
      <li>SmartCarInfo_LoggerSinkì˜ typeì„ <code class="language-plaintext highlighter-rouge">logger</code>ë¡œ ì„¤ì •</li>
      <li>Logger SinkëŠ” ìˆ˜ì§‘í•œ ë°ì´í„°ë¥¼ í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹… ëª©ì ìœ¼ë¡œ í”ŒëŸ¼ì˜ í‘œì¤€ ì¶œë ¥ ë¡œê·¸ íŒŒì¼ì¸ <code class="language-plaintext highlighter-rouge">/var/log/flume-ng/flume-cmf-flume-AGENT-server02.hadoop.com.log</code>ì— ì¶œë ¥</li>
    </ul>
  </li>
  <li>#5
    <ul>
      <li>Sourceì™€ Channel Sink ì—°ê²°</li>
      <li>ì•ì„œ ì •ì˜í•œ SmartCarInfo_SpoolSourceì˜ ì±„ë„ê°’ì„ <code class="language-plaintext highlighter-rouge">SmartCarInfo_Channel</code>ë¡œ ì„¤ì •</li>
      <li>SmartCarInfo_LoggerSinkì˜ ì±„ë„ê°’ë„ <code class="language-plaintext highlighter-rouge">SmartCarInfo_Channel</code>ë¡œ ì„¤ì •</li>
      <li>File -&gt; Channel -&gt; Sinkë¡œ ì´ì–´ì§€ëŠ” ì—ì´ì „íŠ¸ ë¦¬ì†ŒìŠ¤ë¥¼ í•˜ë‚˜ë¡œ ì—°ê²°</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="2-smartcar-ì—ì´ì „íŠ¸ì—-interceptor-ì¶”ê°€">2) SmartCar ì—ì´ì „íŠ¸ì— Interceptor ì¶”ê°€</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">Interceptor</code> : Sourceì™€ Channelì˜ ì¤‘ê°„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” ì—­í• </li>
  <li>í”ŒëŸ¼ì˜ Sourceì—ì„œ ìœ ì…ë˜ëŠ” ë°ì´í„° ì¤‘ ì¼ë¶€ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ í•„ìš”í•œ ë°ì´í„°ë§Œ í•„í„°ë§í•˜ëŠ” ë“± ì¤‘ê°„ì— ë°ì´í„°ë¥¼ ì¶”ê°€/ê°€ê³µ/ì •ì œí•˜ëŠ” ë° ì‚¬ìš©ë¨</li>
  <li>í”ŒëŸ¼ì—ì„œ ë°ì´í„° ì „ì†¡ ë‹¨ìœ„ <code class="language-plaintext highlighter-rouge">Event</code> - Headerì™€ ë³¸ë¬¸ Bodyë¡œ êµ¬ì„±ë¨</li>
  <li>InterceptorëŠ” Eventì˜ Headerì— íŠ¹ì •ê°’ì„ ì¶”ê°€í•˜ê±°ë‚˜ Bodyì— ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ í™œìš©ë¨</li>
</ul>

<p><br /></p>

<ul>
  <li>íŒŒì¼ëŸ¿ í”„ë¡œì íŠ¸ì—ì„œëŠ” SmartCarInfo ë¡œê·¸ íŒŒì¼ì„ ìˆ˜ì§‘í•˜ëŠ”ë° ì´ 4ê°œì˜ Interceptorë¥¼ ì¶”ê°€í•  ê²ƒ</li>
  <li>ì´ë²ˆ ì¥ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">Filter Interceptor</code> í•˜ë‚˜ë§Œ ì¶”ê°€</li>
  <li>ì•ì„œ ì‘ì„±í•œ SmartCarInfo ì—ì´ì „íŠ¸ ìˆ˜ì •í•´ì„œ Filter Interceptor ì‚¬ìš©</li>
</ul>

<p><img src="img/CH03/flume%20interceptor%20ì¶”ê°€.png" alt="" /></p>

<p><br /></p>

<ul>
  <li>CM í™ˆ [Flume] - [êµ¬ì„±] - [êµ¬ì„± íŒŒì¼]</li>
  <li>Sourceì™€ Channel ì‚¬ì´ì— Interceptor ì¶”ê°€</li>
</ul>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>  = <span class="n">SmartCarInfo_SpoolSource</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span> = <span class="n">SmartCarInfo_Channel</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>    = <span class="n">SmartCarInfo_LoggerSink</span> 

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">type</span> = <span class="n">spooldir</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">spoolDir</span> = /<span class="n">home</span>/<span class="n">pilot</span>-<span class="n">pjt</span>/<span class="n">working</span>/<span class="n">car</span>-<span class="n">batch</span>-<span class="n">log</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">deletePolicy</span> = <span class="n">immediate</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">batchSize</span> = <span class="m">1000</span>

<span class="c">#1
</span><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span> = <span class="n">filterInterceptor</span>

<span class="c">#2
</span><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor</span>.<span class="n">type</span> = <span class="n">regex_filter</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor</span>.<span class="n">regex</span> = ^\\<span class="n">d</span>{<span class="m">14</span>}
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor</span>.<span class="n">excludeEvents</span> = <span class="n">false</span>


<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">type</span> = <span class="n">memory</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">capacity</span>  = <span class="m">100000</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">transactionCapacity</span>  = <span class="m">10000</span>


<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">SmartCarInfo_LoggerSink</span>.<span class="n">type</span> = <span class="n">logger</span>

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">channels</span> = <span class="n">SmartCarInfo_Channel</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">SmartCarInfo_LoggerSink</span>.<span class="n">channel</span> = <span class="n">SmartCarInfo_Channel</span>
</code></pre></div></div>

<ul>
  <li>#1
    <ul>
      <li>ìˆ˜ì§‘ ë°ì´í„°ë¥¼ í•„í„°ë§í•˜ê¸° ìœ„í•´ <code class="language-plaintext highlighter-rouge">filterInterceptor</code> ë³€ìˆ˜ë¥¼ ì„ ì–¸í•´ì„œ SmartCarInfo_SpoolSourceì— í• ë‹¹</li>
    </ul>
  </li>
  <li>#2
    <ul>
      <li>filterInterceptorì˜ typeì„ <code class="language-plaintext highlighter-rouge">regex_filter</code>ë¡œ ì„¤ì •</li>
      <li>ì •ê·œ í‘œí˜„ì‹(Regular Expression)ì„ ì´ìš©í•´ ìˆ˜ì§‘ ë°ì´í„°ë¥¼ í•„í„°ë§í•  ë•Œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©</li>
      <li>ì•„ë˜ ì´ë¯¸ì§€ì—ì„œ ìŠ¤ë§ˆíŠ¸ì¹´ ë¡œê·¸ ìƒì„±ê¸°ê°€ ë§Œë“  ë¡œê·¸ íŒŒì¼ ë‚´ìš©ì„ ë³´ë©´, ì¤‘ê°„ì— ë¡œê·¸ í¬ë§·ì˜ í˜•ì‹ì„ ì•Œë¦¬ëŠ” ë©”íƒ€ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŒ</li>
      <li>ì´ ë©”íƒ€ ì •ë³´ë¥¼ ìˆ˜ì§‘ ë°ì´í„°ì—ì„œ ì œì™¸í•˜ê³ , í•„ìš”í•œ ë°ì´í„°ë§Œ ìˆ˜ì§‘í•´ì•¼ í•¨</li>
      <li>ì´ë•Œ ê°„ë‹¨í•œ ì •ê·œ í‘œí˜„ì‹ì„ ì´ìš©í•´ì„œ í•´ê²° ê°€ëŠ¥
        <ul>
          <li>ìŠ¤ë§ˆíŠ¸ì¹´ ë¡œê·¸ì˜ ê²½ìš°) ì •ìƒì ì¸ ë¡œê·¸ ë°ì´í„°ê°€ ë°œìƒí–ˆì„ ë•Œ 14ìë¦¬ì˜ ë‚ ì§œ í˜•ì‹ì„ ê°€ì§</li>
          <li>ì´ 14ìë¦¬ ë‚ ì§œ í˜•ì‹ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë°ì´í„°ì— ëŒ€í•œ ì •ê·œ í‘œí˜„ì‹ <code class="language-plaintext highlighter-rouge">^\\d{14}</code>ë¥¼ â€œregexâ€ ì†ì„±ì— ì„¤ì •</li>
          <li>â€œexcludeEventsâ€ ì†ì„±ì´ <strong>false</strong> ë¡œ ë˜ì–´ìˆëŠ”ë°, <strong>true</strong> ë¡œ í•˜ë©´ ë°˜ëŒ€ë¡œ ì œì™¸ ëŒ€ìƒë§Œ ìˆ˜ì§‘í•˜ê²Œ ë¨</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="3-drivercarinfo-ì—ì´ì „íŠ¸-ìƒì„±">3) DriverCarInfo ì—ì´ì „íŠ¸ ìƒì„±</h3>
<ul>
  <li>ì•ì„œ ì‘ì„±í•œ SmartCar ì—ì´ì „íŠ¸ì— DriverCarInfo ì—ì´ì „íŠ¸ë¥¼ ìœ„í•œ Source, Channel, Sinkë¥¼ ì¶”ê°€í•˜ì—¬ ìƒì„±</li>
  <li>í•œ ê°œì˜ í”ŒëŸ¼ ì—ì´ì „íŠ¸ íŒŒì¼ì— ì—¬ëŸ¬ ê°œì˜ ì—ì´ì „íŠ¸ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©</li>
</ul>

<p><br /></p>

<ul>
  <li><strong>DriverCarInfo ë¦¬ì†ŒìŠ¤ ë³€ìˆ˜ ì¶”ê°€</strong></li>
</ul>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#1
</span><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>  = <span class="n">SmartCarInfo_SpoolSource</span> <span class="n">DriverCarInfo_TailSource</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span> = <span class="n">SmartCarInfo_Channel</span> <span class="n">DriverCarInfo_Channel</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>    = <span class="n">SmartCarInfo_LoggerSink</span> <span class="n">DriverCarInfo_KafkaSink</span>

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">type</span> = <span class="n">spooldir</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">spoolDir</span> = /<span class="n">home</span>/<span class="n">pilot</span>-<span class="n">pjt</span>/<span class="n">working</span> /<span class="n">car</span>-<span class="n">batch</span>-<span class="n">log</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">deletePolicy</span> = <span class="n">immediate</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">batchSize</span> = <span class="m">1000</span>

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span> = <span class="n">filterInterceptor</span>

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor</span>.<span class="n">type</span> = <span class="n">regex_filter</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor</span>.<span class="n">regex</span> = ^\\<span class="n">d</span>{<span class="m">14</span>}
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor</span>.<span class="n">excludeEvents</span> = <span class="n">false</span>


<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">type</span> = <span class="n">memory</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">capacity</span>  = <span class="m">100000</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">transactionCapacity</span>  = <span class="m">10000</span>


<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">SmartCarInfo_LoggerSink</span>.<span class="n">type</span> = <span class="n">logger</span>

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">channels</span> = <span class="n">SmartCarInfo_Channel</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">SmartCarInfo_LoggerSink</span>.<span class="n">channel</span> = <span class="n">SmartCarInfo_Channel</span>
</code></pre></div></div>
<ul>
  <li>#1
    <ul>
      <li>ì—ì´ì „íŠ¸ì˜ Source, Channel, Sinkì— DriverCarInfo ë¦¬ì†ŒìŠ¤ ë³€ìˆ˜ ì¶”ê°€</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<ul>
  <li><strong>DriverCarInfo ì„¤ì • ì¶”ê°€</strong></li>
</ul>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>  = <span class="n">SmartCarInfo_SpoolSource</span> <span class="n">DriverCarInfo_TailSource</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span> = <span class="n">SmartCarInfo_Channel</span> <span class="n">DriverCarInfo_Channel</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>    = <span class="n">SmartCarInfo_LoggerSink</span> <span class="n">DriverCarInfo_KafkaSink</span>

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">type</span> = <span class="n">spooldir</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">spoolDir</span> = /<span class="n">home</span>/<span class="n">pilot</span>-<span class="n">pjt</span>/<span class="n">working</span>/<span class="n">car</span>-<span class="n">batch</span>-<span class="n">log</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">deletePolicy</span> = <span class="n">immediate</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">batchSize</span> = <span class="m">1000</span>

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span> = <span class="n">filterInterceptor</span>

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor</span>.<span class="n">type</span> = <span class="n">regex_filter</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor</span>.<span class="n">regex</span> = ^\\<span class="n">d</span>{<span class="m">14</span>}
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor</span>.<span class="n">excludeEvents</span> = <span class="n">false</span>


<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">type</span> = <span class="n">memory</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">capacity</span>  = <span class="m">100000</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">SmartCarInfo_Channel</span>.<span class="n">transactionCapacity</span>  = <span class="m">10000</span>


<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">SmartCarInfo_LoggerSink</span>.<span class="n">type</span> = <span class="n">logger</span>

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">SmartCarInfo_SpoolSource</span>.<span class="n">channels</span> = <span class="n">SmartCarInfo_Channel</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">SmartCarInfo_LoggerSink</span>.<span class="n">channel</span> = <span class="n">SmartCarInfo_Channel</span>

<span class="c">#1
</span><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">DriverCarInfo_TailSource</span>.<span class="n">type</span> = <span class="n">exec</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">DriverCarInfo_TailSource</span>.<span class="n">command</span> = <span class="n">tail</span> -<span class="n">F</span> /<span class="n">home</span>/<span class="n">pilot</span>-<span class="n">pjt</span>/<span class="n">working</span>/<span class="n">driver</span>-<span class="n">realtime</span>-<span class="n">log</span>/<span class="n">SmartCarDriverInfo</span>.<span class="n">log</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">DriverCarInfo_TailSource</span>.<span class="n">restart</span> = <span class="n">true</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">DriverCarInfo_TailSource</span>.<span class="n">batchSize</span> = <span class="m">1000</span>

<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">DriverCarInfo_TailSource</span>.<span class="n">interceptors</span> = <span class="n">filterInterceptor2</span>

<span class="c">#2
</span><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">DriverCarInfo_TailSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor2</span>.<span class="n">type</span> = <span class="n">regex_filter</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">DriverCarInfo_TailSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor2</span>.<span class="n">regex</span> = ^\\<span class="n">d</span>{<span class="m">14</span>}
<span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">DriverCarInfo_TailSource</span>.<span class="n">interceptors</span>.<span class="n">filterInterceptor2</span>.<span class="n">excludeEvents</span> = <span class="n">false</span>

<span class="c">#3
</span><span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">DriverCarInfo_KafkaSink</span>.<span class="n">type</span> = <span class="n">org</span>.<span class="n">apache</span>.<span class="n">flume</span>.<span class="n">sink</span>.<span class="n">kafka</span>.<span class="n">KafkaSink</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">DriverCarInfo_KafkaSink</span>.<span class="n">topic</span> = <span class="n">SmartCar</span>-<span class="n">Topic</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">DriverCarInfo_KafkaSink</span>.<span class="n">brokerList</span> = <span class="n">server02</span>.<span class="n">hadoop</span>.<span class="n">com</span>:<span class="m">9092</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">DriverCarInfo_KafkaSink</span>.<span class="n">requiredAcks</span> = <span class="m">1</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">DriverCarInfo_KafkaSink</span>.<span class="n">batchSize</span> = <span class="m">1000</span>

<span class="c">#4
</span><span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">DriverCarInfo_Channel</span>.<span class="n">type</span> = <span class="n">memory</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">DriverCarInfo_Channel</span>.<span class="n">capacity</span>= <span class="m">100000</span>
<span class="n">SmartCar_Agent</span>.<span class="n">channels</span>.<span class="n">DriverCarInfo_Channel</span>.<span class="n">transactionCapacity</span> = <span class="m">10000</span>

<span class="c">#5
</span><span class="n">SmartCar_Agent</span>.<span class="n">sources</span>.<span class="n">DriverCarInfo_TailSource</span>.<span class="n">channels</span> = <span class="n">DriverCarInfo_Channel</span>
<span class="n">SmartCar_Agent</span>.<span class="n">sinks</span>.<span class="n">DriverCarInfo_KafkaSink</span>.<span class="n">channel</span> = <span class="n">DriverCarInfo_Channel</span>
</code></pre></div></div>

<ul>
  <li>ì•ì„œ ì„ ì–¸í•œ SmartCarInfo ì—ì´ì „íŠ¸ì™€ ìœ ì‚¬í•˜ê²Œ Source, Interceptor, Channel, Sink ìˆœì„œëŒ€ë¡œ ì •ì˜</li>
  <li>ì¼ë¶€ Sourceì™€ Sink ìœ í˜•ì´ ë‹¬ë¼ì§</li>
</ul>

<p><br /></p>

<ul>
  <li>#1
    <ul>
      <li>Sourceì˜ typeì´ <code class="language-plaintext highlighter-rouge">exec</code></li>
      <li><code class="language-plaintext highlighter-rouge">exec</code>ëŠ” í”ŒëŸ¼ ì™¸ë¶€ì—ì„œ ìˆ˜í–‰í•œ ëª…ë ¹ì˜ ê²°ê³¼ë¥¼ í”ŒëŸ¼ì˜ Eventë¡œ ê°€ì ¸ì™€ ìˆ˜ì§‘í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ ì œê³µ</li>
      <li>ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ìì˜ ìš´í–‰ ì •ë³´ê°€ ë¡œê·¸ ì‹œë®¬ë ˆì´í„°ë¥¼ í†µí•´ <code class="language-plaintext highlighter-rouge">/home/pilot-pjt/working/driver-realtime-log/SmartCarDriverInfo.log</code>ì— ìƒì„±
  -&gt; ë¦¬ëˆ…ìŠ¤ì˜ <code class="language-plaintext highlighter-rouge">tail</code> ëª…ë ¹ì„ í”ŒëŸ¼ì˜ <code class="language-plaintext highlighter-rouge">exec</code>ë¥¼ ì‹¤í–‰í•´ì„œ ìš´ì „ìì˜ ì‹¤ì‹œê°„ ìš´í–‰ ì •ë³´ ìˆ˜ì§‘</li>
    </ul>
  </li>
  <li>#2
    <ul>
      <li>Interceptor ì •ì˜</li>
      <li>ë°ì´í„° í•„í„°ë§ì„ ìœ„í•œ <code class="language-plaintext highlighter-rouge">regex_filter</code>ë§Œ ì¶”ê°€</li>
    </ul>
  </li>
  <li>#3
    <ul>
      <li>ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ìì˜ ì‹¤ì‹œê°„ ìš´í–‰ ì •ë³´ëŠ” í”ŒëŸ¼ì—ì„œ ìˆ˜ì§‘ê³¼ ë™ì‹œì— ì¹´í”„ì¹´ë¡œ ì „ì†¡</li>
      <li>í”ŒëŸ¼ì˜ <code class="language-plaintext highlighter-rouge">KafkaSink</code>ì˜ ë‚´ìš©ì„ ë³´ë©´, ì¹´í”„ì¹´ ë¸Œë¡œì»¤ ì„œë²„ê°€ ì‹¤í–‰ì¤‘ì¸ server02.hadoop.com:9092ì— ì—°ê²°í•´ì„œ SmartCar-Topicì— ë°ì´í„°ë¥¼ 100ê°œì˜ ë°°ì¹˜ í¬ê¸°ë¡œ ì „ì†¡</li>
    </ul>
  </li>
  <li>#4
    <ul>
      <li>DriverCarInfoì˜ Channelì„ <code class="language-plaintext highlighter-rouge">Memory Channel</code>ë¡œ ì„ ì–¸</li>
    </ul>
  </li>
  <li>#5
    <ul>
      <li>DriverCarInfoì˜ Sourceì™€ Sinkì˜ Channelì„ ì•ì„œ ì •ì˜í•œ DriverCarInfo_Channelë¡œ ì„¤ì •í•´ì„œ Source-Channel-Sink êµ¬ì¡° ì™„ì„±</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="4-ì¹´í”„ì¹´-ê¸°ëŠ¥-êµ¬í˜„">4. ì¹´í”„ì¹´ ê¸°ëŠ¥ êµ¬í˜„</h2>
<ul>
  <li>ì¹´í”„ì¹´ì— ëŒ€í•œ ì§ì ‘ì ì¸ ê¸°ëŠ¥ êµ¬í˜„ì€ í•˜ì§€ ì•ŠìŒ</li>
  <li>ì´ë¯¸ í”ŒëŸ¼ì˜ <code class="language-plaintext highlighter-rouge">DriverCarInfo_KafkaSink</code>ë¥¼ í†µí•´ ìˆ˜ì§‘í•œ ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ì¹´í”„ì¹´ì— ì „ì†¡í•˜ëŠ” ê¸°ëŠ¥ êµ¬í˜„ì€ ëë‚¬ê¸° ë•Œë¬¸</li>
  <li>ì¹´í”„ì¹´ ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ ì¹´í”„ì¹´ì˜ <code class="language-plaintext highlighter-rouge">ë¸Œë¡œì»¤</code> ì•ˆì— ì•ìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ ë  í† í”½ ìƒì„± &amp; ì¹´í”„ì¹´ì˜ <code class="language-plaintext highlighter-rouge">Producer</code> ëª…ë ¹ì„ í†µí•´ í† í”½ì— ë°ì´í„° ì „ì†¡</li>
  <li>í† í”½ì— ë“¤ì–´ê°„ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ì¹´í”„ì¹´ì˜ <code class="language-plaintext highlighter-rouge">Consumer</code> ëª…ë ¹ì–´ë¡œ ìˆ˜ì‹ </li>
</ul>

<p><br /></p>

<h3 id="1-ì¹´í”„ì¹´-topic-ìƒì„±">1) ì¹´í”„ì¹´ Topic ìƒì„±</h3>
<ul>
  <li>ì¹´í”„ì¹´ê°€ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” Server02ì—ì„œ ì¹´í”„ì¹´ì˜ <code class="language-plaintext highlighter-rouge">CLI</code> ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ ë‹¤ì–‘í•œ ì¹´í”„ì¹´ ê¸°ëŠ¥ ì‚¬ìš©</li>
  <li>PuTTYë¡œ Server02ì— SSH ì ‘ì† - root ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸</li>
  <li>ì•„ë˜ ì¹´í”„ì¹´ í† í”½ ëª…ë ¹ì–´ë¡œ <strong>SmartCar-Topic</strong> ìƒì„±
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kafka-topics <span class="nt">--create</span> <span class="nt">--zookeeper</span> server02.hadoop.2181 <span class="nt">--replication-factor</span> 1 <span class="nt">--partitions</span> 1 <span class="nt">--topic</span> SmartCar-Topic
</code></pre></div>    </div>
  </li>
</ul>

<p><img src="img/CH03/kafka%20topic%20ìƒì„±.png" alt="" /></p>

<p><br /></p>

<ul>
  <li>ìœ„ ëª…ë ¹ì–´ ì‹¤í–‰í•˜ê³  <code class="language-plaintext highlighter-rouge">Created Topic SmartCar-Topic</code> ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ë©´ í† í”½ì´ ì •ìƒì ìœ¼ë¡œ ìƒì„±ëœ ê²ƒ</li>
  <li><code class="language-plaintext highlighter-rouge">--zookeeper</code> ì˜µì…˜
    <ul>
      <li>í† í”½ì˜ ë©”íƒ€ ì •ë³´ë“¤ì´ Zookeeperì˜ Zë…¸ë“œì— ë§Œë“¤ì–´ì§€ê³  ê´€ë¦¬ë¨</li>
      <li><code class="language-plaintext highlighter-rouge">replication-factor</code> ì˜µì…˜ì€ ì¹´í”„ì¹´ë¥¼ ë‹¤ì¤‘ Brokerë¡œ ë§Œë“¤ê³ , ì „ì†¡í•œ ë°ì´í„°ë¥¼ replication-factor ê°œìˆ˜ë§Œí¼ ë³µì œí•˜ê²Œ ë¨. íŒŒì¼ëŸ¿ í”Œì ì€ ë‹¨ì¼ ì¹´í”„ì¹´ ë¸Œë¡œì»¤ -&gt; ë³µì œ ê°œìˆ˜ 1</li>
      <li><code class="language-plaintext highlighter-rouge">partitions</code> ì˜µì…˜ì€ í•´ë‹¹ Topicì— ë°ì´í„°ë“¤ì€ partitions ê°œìˆ˜ë§Œí¼ ë¶„ë¦¬ ì €ì¥í•˜ê²Œ ë¨. ë‹¤ì¤‘ Brokerì—ì„œ ì“°ê¸°/ì½ê¸° ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ ì‚¬ìš©</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">--topic</code> ì˜µì…˜
    <ul>
      <li>íŒŒì¼ëŸ¿ í™˜ê²½ì—ì„œ ì‚¬ìš©í•  í† í”½ëª… ì •ì˜</li>
      <li><strong>SmartCar-Topic</strong>ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í† í”½ ì •ì˜</li>
      <li>í”ŒëŸ¼ì˜ DriverCarInfo_KafkaSinkì—ì„œ ì„¤ì •í•œ í† í”½ ì´ë¦„ê³¼ ê°™ì•„ì•¼ í•¨</li>
      <li>í† í”½ ì‚­ì œ ëª…ë ¹ì–´
  <code class="language-plaintext highlighter-rouge">kafka-topics --delete --zookeeper server02.hadoop.com:2181 --topic í† í”½ëª…</code></li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="2-ì¹´í”„ì¹´-producer-ì‚¬ìš©">2) ì¹´í”„ì¹´ Producer ì‚¬ìš©</h3>
<ul>
  <li>Server02 SSH ì ‘ì† í›„ ì•„ë˜ ëª…ë ¹ ì‹¤í–‰
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kafka-console-producer <span class="nt">--broker-list</span> server02.hadoop.com:9092 <span class="nt">-topic</span> SmartCar-Topic
</code></pre></div>    </div>
  </li>
  <li>ì´í›„ <code class="language-plaintext highlighter-rouge">Hello! BigData!</code> ë¥¼ ì…ë ¥í•˜ê³  ì—”í„° í‚¤ë¥¼ ëˆ„ë¦„</li>
  <li>ì—ëŸ¬ ë©”ì‹œì§€ê°€ ì—†ìœ¼ë©´ <strong>SmartCar-Topic</strong>ì— â€œHello! BigData!â€ ë©”ì‹œì§€ë¥¼ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡í•œ ê²ƒ</li>
</ul>

<p><img src="img/CH03/kafka%20producer(1).png" alt="" />    <br />
<img src="img/CH03/kafka%20producer(2).png" alt="" /></p>

<p><br /></p>

<ul>
  <li>ì¹´í”„ì¹´ Producerì™€ Consumer ê¸°ëŠ¥ ì ê²€</li>
</ul>

<p><img src="img/CH03/producer.jpg" alt="" /></p>

<ul>
  <li>ì•ì„œ Producerê°€ ì „ì†¡í•œ â€œHello! BigData!â€ ë©”ì‹œì§€ëŠ” ì•„ì§ ì¹´í”„ì¹´ í† í”½ì— ë¨¸ë¬¼ëŸ¬ ìˆëŠ” ìƒíƒœ</li>
  <li>Consumer ì½˜ì†” 1, 2ë¥¼ ì‹¤í–‰í•´ì„œ <strong>SmartCar-Topic</strong>ì— ì—°ê²°í•˜ë©´ â€œHello! BigData!â€ ë©”ì‹œì§€ë¥¼ Consumerê°€ ë™ì‹œì— ìˆ˜ì‹ ë°›ê²Œ ë  ê²ƒ</li>
</ul>

<p><br /></p>

<h3 id="3-ì¹´í”„ì¹´-consumer-ì‚¬ìš©">3) ì¹´í”„ì¹´ Consumer ì‚¬ìš©</h3>
<ul>
  <li>Server02ì— SSH í„°ë¯¸ë„ì„ 2ê°œ ì—´ì–´ì„œ ê°ê°ì— ì•„ë˜ ì¹´í”„ì¹´ Consumer ëª…ë ¹ ì‹¤í–‰
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kafka-console-consumer <span class="nt">--bootstrap-server</span> server02.hadoop.com:9092 <span class="nt">--topic</span> SmartCar-Topic <span class="nt">--partition</span> 0 <span class="nt">--from-beginning</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>ì‹¤í–‰ê³¼ ë™ì‹œì— Producerì—ì„œ ì…ë ¥í–ˆë˜ â€œHello! BigData!â€ê°€ ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ</li>
</ul>

<p><img src="img/CH03/kafka%20consumer(1).png" alt="" />
<img src="img/CH03/kafka%20consumer(2).png" alt="" /></p>

<ul>
  <li>ìœ„ì—ì„œ â€œHello! BigData!â€ë¥¼ ì…ë ¥í–ˆë˜ Producer ì½˜ì†”ì°½ì—ì„œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•  ë•Œë§ˆë‹¤ 2ê°œì˜ Consumer ì½˜ì†”ì°½ì— ë¸Œë¡œë“œìºìŠ¤íŠ¸ë˜ì–´ ë™ì¼ ë©”ì‹œì§€ê°€ ìˆ˜ì‹ ë¨</li>
</ul>

<p><br /></p>

<h2 id="5-ìˆ˜ì§‘-ê¸°ëŠ¥-í…ŒìŠ¤íŠ¸">5. ìˆ˜ì§‘ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h2>

<h3 id="1-smartcar-ë¡œê·¸-ì‹œë®¬ë ˆì´í„°-ì‘ë™">1) SmartCar ë¡œê·¸ ì‹œë®¬ë ˆì´í„° ì‘ë™</h3>
<ul>
  <li>2016ë…„ 1ì›” 1ì¼ì— 3ëŒ€ì˜ ìŠ¤ë§ˆíŠ¸ì¹´ ë¡œê·¸ë§Œ ë°œìƒì‹œì¼œ ë³´ê¸°</li>
</ul>

<h4 id="1-server02ì—-ssh-ì ‘ì†-í›„-bigdatasmartcarloggen-10jarê°€-ìœ„ì¹˜í•œ-ê³³ìœ¼ë¡œ-ì´ë™">1) Server02ì— SSH ì ‘ì† í›„ bigdata.smartcar.loggen-1.0.jarê°€ ìœ„ì¹˜í•œ ê³³ìœ¼ë¡œ ì´ë™</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/pilot-pjt/working
</code></pre></div></div>

<p><br /></p>

<h4 id="2-ë‹¤ìŒ-ëª…ë ¹ìœ¼ë¡œ-2ê°œì˜-ìŠ¤ë§ˆíŠ¸ì¹´-ë¡œê·¸-ì‹œë®¬ë ˆì´í„°ë¥¼-ë°±ê·¸ë¼ìš´ë“œ-ë°©ì‹ìœ¼ë¡œ-ì‹¤í–‰">2) ë‹¤ìŒ ëª…ë ¹ìœ¼ë¡œ 2ê°œì˜ ìŠ¤ë§ˆíŠ¸ì¹´ ë¡œê·¸ ì‹œë®¬ë ˆì´í„°ë¥¼ ë°±ê·¸ë¼ìš´ë“œ ë°©ì‹ìœ¼ë¡œ ì‹¤í–‰</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-cp</span> bigdata.smartcar.loggen-1.0.jar com.wikibook.bigdata.smartcar.loggen.CarLogMain 20160101 3 &amp;
java <span class="nt">-cp</span> bigdata.smartcar.loggen-1.0.jar com.wikibook.bigdata.smartcar.loggen.DriverLogMain 20160101 3 &amp;
</code></pre></div></div>

<p><img src="img/CH03/smartcar%20log%20ì‹œë®¬ë ˆì´í„°%20ì‘ë™.png" alt="" /></p>

<ul>
  <li>2016ë…„ 1ì›” 1ì¼ì— 3ëŒ€ì˜ ìŠ¤ë§ˆíŠ¸ì¹´ì— ëŒ€í•œ ìƒíƒœ ì •ë³´ì™€ ìš´ì „ìì˜ ìš´í–‰ ì •ë³´ ìƒì„± ì‹œì‘</li>
</ul>

<p><br /></p>

<h4 id="3-ì •ìƒì ìœ¼ë¡œ-ì‹œë®¬ë ˆì´í„°ê°€-ì‘ë™ë˜ê³ -ìˆëŠ”ì§€-ì•„ë˜-ë‚´ìš©ìœ¼ë¡œ-í™•ì¸">3) ì •ìƒì ìœ¼ë¡œ ì‹œë®¬ë ˆì´í„°ê°€ ì‘ë™ë˜ê³  ìˆëŠ”ì§€ ì•„ë˜ ë‚´ìš©ìœ¼ë¡œ í™•ì¸</h4>
<ul>
  <li>/home/pilot-pjt/working/SmartCar ê²½ë¡œì— SmartCarStatusInfo_20160101.txt íŒŒì¼ì´ ìƒì„±ëëŠ”ì§€ í™•ì¸</li>
  <li>íŒŒì¼ì˜ ë‚´ìš© í™•ì¸í•´ë³´ë©´ 3ëŒ€ì˜ ìŠ¤ë§ˆíŠ¸ì¹´ ìƒíƒœ ì •ë³´ê°€ ê¸°ë¡ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/pilot-pjt/working/SmartCar
vi SmartCarStatusInfo_20160101.txt
</code></pre></div>    </div>
  </li>
</ul>

<p><img src="img/CH03/smartcarstatusinfo%20íŒŒì¼%20ìƒì„±%20í™•ì¸.png" alt="" /></p>

<p><br /></p>

<ul>
  <li>/home/pilot-pjt/working/driver-realtime-log ê²½ë¡œì— SmartCarDriverInfo.log íŒŒì¼ ìƒì„±ëëŠ”ì§€ í™•ì¸</li>
  <li>tail -f SmartCarDriverInfo.log ëª…ë ¹ì„ í†µí•´ 3ëŒ€ì˜ ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ìì˜ ìš´í–‰ ì •ë³´ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/pilot-pjt/working/driver-realtime-log
<span class="nb">tail</span> <span class="nt">-f</span> SmartCarDriverInfo.log
</code></pre></div></div>

<p><img src="img/CH03/smartcardriverinfo%20íŒŒì¼%20ìƒì„±%20í™•ì¸.png" alt="" /></p>

<p><br /></p>

<h4 id="4-homepilot-pjtworkingsmartcar-ê²½ë¡œì—-ë§Œë“¤ì–´ì§„-smartcarstatusinfo_20160101txt-íŒŒì¼ì„-í”ŒëŸ¼-smartcarinfo-ì—ì´ì „íŠ¸ì˜-spooldir-ê²½ë¡œë¡œ-ì˜®ê¹€">4) /home/pilot-pjt/working/SmartCar ê²½ë¡œì— ë§Œë“¤ì–´ì§„ SmartCarStatusInfo_20160101.txt íŒŒì¼ì„ í”ŒëŸ¼ SmartCarInfo ì—ì´ì „íŠ¸ì˜ SpoolDir ê²½ë¡œë¡œ ì˜®ê¹€</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mv</span> /home/pilot-pjt/working/SmartCar/SmartCarStatusInfo_20160101.txt /home/pilot-pjt/working/car-batch-log/
</code></pre></div></div>

<p><img src="img/CH03/smartcarstatusinfo%20íŒŒì¼%20ì´ë™.png" alt="" /></p>

<p><br /></p>

<h3 id="2-í”ŒëŸ¼-ì—ì´ì „íŠ¸-ì‘ë™">2) í”ŒëŸ¼ ì—ì´ì „íŠ¸ ì‘ë™</h3>
<ul>
  <li>í”ŒëŸ¼ ì—ì´ì „íŠ¸ë¥¼ ì‘ë™ì‹œì¼œ ìŠ¤ë§ˆíŠ¸ì¹´ ë¡œê·¸ ì‹œë®¬ë ˆì´í„°ê°€ ë§Œë“¤ì–´ë‚¸ ë‘ ìœ í˜•ì˜ ë¡œê·¸ ìˆ˜ì§‘</li>
  <li>CM í™ˆ - [Flume] - [ì¬ì‹œì‘] - í”ŒëŸ¼ ì—ì´ì „íŠ¸ ì¬ê¸°ë™</li>
</ul>

<p><br /></p>

<h3 id="3-ì¹´í”„ì¹´-consumer-ì‘ë™">3) ì¹´í”„ì¹´ Consumer ì‘ë™</h3>
<ul>
  <li>Server02ì— ì ‘ì†í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì€ ì¹´í”„ì¹´ ëª…ë ¹ ì‹¤í–‰</li>
  <li>ì´ì „ì— ì‚¬ìš©í•œ Consumer ëª…ë ¹ê³¼ -from-beginning ì˜µì…˜ì€ ìƒëµ
    <ul>
      <li>-from-beginning ì˜µì…˜: í•´ë‹¹ í† í”½ì— ì €ì¥ëœ ì²« ë°ì´í„°ë¶€í„° ë§ˆì§€ë§‰ ë°ì´í„°ê¹Œì§€ ì¼ê´„ ìˆ˜ì‹  í›„ ëŒ€ê¸°í•˜ê²Œ ë¨</li>
      <li>ì—¬ê¸°ì„œëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ë°œìƒëœ ë°ì´í„°ë§Œ ìˆ˜ì‹ í•  ê²ƒì´ë¯€ë¡œ í•´ë‹¹ ì˜µì…˜ ì œì™¸</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kafka-console-consumer <span class="nt">--bootstrap-server</span> server02.hadoop.com:9092 <span class="nt">--topic</span> SmartCar-Topic <span class="nt">--partition</span> 0
</code></pre></div></div>

<p><img src="img/CH03/kafka%20consumer%20ì‘ë™.png" alt="" /></p>

<p><br /></p>

<ul>
  <li>ì•ì„œ ì‹¤í–‰í•œ ì‹œë®¬ë ˆì´í„°ì— ì˜í•´ ìŠ¤ë§ˆíŠ¸ì¹´ì˜ ìš´í–‰ ë¡œê·¸ ë°ì´í„°ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¹´í”„ì¹´ì— ìœ ì…ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ</li>
</ul>

<p><br /></p>

<h3 id="4-ìˆ˜ì§‘-ê¸°ëŠ¥-ì ê²€">4) ìˆ˜ì§‘ ê¸°ëŠ¥ ì ê²€</h3>

<h4 id="1-ìŠ¤ë§ˆíŠ¸ì¹´ì˜-ìƒíƒœ-ì •ë³´-ë¡œê·¸-íŒŒì¼ì´-í”ŒëŸ¼ì˜-í‘œì¤€-ì¶œë ¥-ë¡œê·¸ë¡œ-ì „ì†¡ëëŠ”ì§€-ë¦¬ëˆ…ìŠ¤-tail-ëª…ë ¹ì–´ë¡œ-í™•ì¸">1) ìŠ¤ë§ˆíŠ¸ì¹´ì˜ ìƒíƒœ ì •ë³´ ë¡œê·¸ íŒŒì¼ì´ í”ŒëŸ¼ì˜ í‘œì¤€ ì¶œë ¥ ë¡œê·¸ë¡œ ì „ì†¡ëëŠ”ì§€ ë¦¬ëˆ…ìŠ¤ tail ëª…ë ¹ì–´ë¡œ í™•ì¸</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tail</span> <span class="nt">-f</span> /var/log/flume-ng/flume-cmf-flume-AGENT-server02.hadoop.com.log
</code></pre></div></div>

<p><br /></p>

<ul>
  <li>ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ ìˆ˜ì§‘ëœ ìŠ¤ë§ˆíŠ¸ì¹´ì˜ ìƒíƒœê°’ ë°ì´í„°ê°€ ì¶œë ¥ë˜ë©´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì§‘ë˜ê³  ìˆëŠ” ê²ƒ</li>
</ul>

<p><img src="img/CH03/ìˆ˜ì§‘ê¸°ëŠ¥ì ê²€(1).png" alt="" /></p>

<ul>
  <li>ì°¸ê³ ë¡œ ì¶œë ¥ë˜ê³  ìˆëŠ” ë¡œê·¸ì˜ ë‚´ìš©ì„ ë³´ë©´, í”ŒëŸ¼ì˜ ë°ì´í„° ì „ì†¡ ë‹¨ìœ„ì¸ Eventê°€ Headerì™€ Body êµ¬ì¡°ë¡œ ë¶„ë¦¬ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ</li>
</ul>

<p><br /></p>

<h4 id="2-ìŠ¤ë§ˆíŠ¸ì¹´-ìš´ì „ìì˜-ì‹¤ì‹œê°„-ìš´ì „-ì •ë³´ì¸-drivercarinfoê°€-ì •ìƒì ìœ¼ë¡œ-ìˆ˜ì§‘ë˜ëŠ”ì§€-í™•ì¸">2) ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ìì˜ ì‹¤ì‹œê°„ ìš´ì „ ì •ë³´ì¸ DriverCarInfoê°€ ì •ìƒì ìœ¼ë¡œ ìˆ˜ì§‘ë˜ëŠ”ì§€ í™•ì¸</h4>
<ul>
  <li>ì•ì„œ ì‹¤í–‰í–ˆë˜ ì¹´í”„ì¹´ì˜ Consumer ì½˜ì†”ì°½ í™•ì¸</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kafka-console-consumer <span class="nt">--bootstrap-server</span> server02.hadoop.com:9092 <span class="nt">--topic</span> SmartCar-Topic <span class="nt">--partition</span> 0
</code></pre></div></div>

<p><br /></p>

<ul>
  <li>ì•„ë˜ì™€ ê°™ì´ ìŠ¤ë§ˆíŠ¸ì¹´ì˜ ìš´ì „ì ì •ë³´ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ìˆ˜ì§‘ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŒ</li>
</ul>

<p><img src="img/CH03/ìˆ˜ì§‘ê¸°ëŠ¥ì ê²€(2).png" alt="" /></p>

<p><br /></p>

<h4 id="3-ë°±ê·¸ë¼ìš´ë“œë¡œ-ì‹¤í–‰í–ˆë˜-ìŠ¤ë§ˆíŠ¸ì¹´-ë¡œê·¸-ì‹œë®¬ë ˆì´í„°-ëª¨ë‘-ì¢…ë£Œ">3) ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰í–ˆë˜ ìŠ¤ë§ˆíŠ¸ì¹´ ë¡œê·¸ ì‹œë®¬ë ˆì´í„° ëª¨ë‘ ì¢…ë£Œ</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ps <span class="nt">-ef</span> | <span class="nb">grep </span>smartcar.log
</code></pre></div></div>

<p><br /></p>

<ul>
  <li>ìœ„ ëª…ë ¹ì–´ë¡œ ì¡°íšŒëœ ë‘ ìë°” í”„ë¡œì„¸ìŠ¤ (CarLogMain, DriverLogMain)ì˜ pidë¥¼ ì°¾ì•„ ê°•ì œ ì¢…ë£Œ
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">kill</span> <span class="nt">-9</span> <span class="o">[</span>pid]
</code></pre></div>    </div>
  </li>
</ul>

<p><br /></p>

<h2 id="6-íŒŒì¼ëŸ¿-í™˜ê²½ì˜-ë¡œê·¸-í™•ì¸">6. íŒŒì¼ëŸ¿ í™˜ê²½ì˜ ë¡œê·¸ í™•ì¸</h2>
<ul>
  <li>Hadoop ì—ì½”ì‹œìŠ¤í…œ ì„œë²„ë“¤ì˜ ë¡œê·¸ ìœ„ì¹˜ : /var/log/ë””ë ‰í„°ë¦¬(cloudera, Hadoop, Oozie ë“±)</li>
  <li>Redis ì„œë²„ ë¡œê·¸ ìœ„ì¹˜ : /var/log/redis_6379.log</li>
  <li>Storm ì„œë²„ ë¡œê·¸ ìœ„ì¹˜ : /var/log/storm/</li>
  <li>Zeppelin ì„œë²„ ë¡œê·¸ ìœ„ì¹˜ : /home/pilot-pjt/zeppelin-0.8.2-bin-all/logs</li>
</ul>

<p><br /></p>

<h2 id="7-íŒŒì¼ëŸ¿-í™˜ê²½ì—ì„œ-hdfs-ë¬¸ì œ-ë°œìƒ">7. íŒŒì¼ëŸ¿ í™˜ê²½ì—ì„œ HDFS ë¬¸ì œ ë°œìƒ</h2>
<ul>
  <li>ê°œì¸ì˜ íŒŒì¼ëŸ¿ í”„ë¡œì íŠ¸ í™˜ê²½ì€ ê°€ìƒë¨¸ì‹ ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆì–´ ë¹„ì •ìƒì ì¸ ì¢…ë£Œê°€ ìì£¼ ë°œìƒí•  ìˆ˜ ìˆìŒ</li>
  <li>ì´ë•Œ HDFS ìƒì— CORRUPT BLOCKS/FILES ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜, Safe ëª¨ë“œë¡œ ì „í™˜ë˜ì–´ ë¹ ì ¸ë‚˜ì˜¤ì§€ ëª»í•˜ëŠ” ê²½ìš°ê°€ ìì£¼ ë°œìƒ</li>
  <li>íŒŒì¼ëŸ¿ í™˜ê²½ì˜ ì¼ë¶€ ê¸°ëŠ¥ ë˜ëŠ” ì„¤ì¹˜ ì¤‘ì— ë¬¸ì œê°€ ë°œìƒí•œë‹¤ë©´ HDFSì˜ íŒŒì¼/ë¸”ë¡ ê¹¨ì§ ë˜ëŠ” Safe ëª¨ë“œ ì „í™˜ ì—¬ë¶€ ì²´í¬í•´ì•¼ í•¨</li>
</ul>

<p><br /></p>

<ul>
  <li>HDFS íŒŒì¼ ì‹œìŠ¤í…œ ê²€ì‚¬ : <code class="language-plaintext highlighter-rouge">hdfs fsck /</code></li>
  <li>HDFSì— Safe ëª¨ë“œ ë°œìƒ í›„ ë¹ ì ¸ë‚˜ì˜¤ì§€ ëª»í•  ê²½ìš° Safe ëª¨ë“œ ê°•ì œ í•´ì œ : <code class="language-plaintext highlighter-rouge">hdfs dfsadmin -safamode leave</code></li>
  <li>HDFSì— CORRUPT BLOCKS/FILES ë“±ì´ ë°œìƒí•´ ë³µêµ¬ê°€ ë¶ˆê°€ëŠ¥í•œ ê²½ìš°
    <ul>
      <li>ì†ìƒëœ íŒŒì¼ ê°•ì œ ì‚­ì œ : <code class="language-plaintext highlighter-rouge">hdfs fsck / -delete</code></li>
      <li>ì†ìƒëœ íŒŒì¼ì„ /lost + found ë””ë ‰í„°ë¦¬ë¡œ ì´ë™ : <code class="language-plaintext highlighter-rouge">hdfs fsck / -move</code></li>
    </ul>
  </li>
</ul>
:ET