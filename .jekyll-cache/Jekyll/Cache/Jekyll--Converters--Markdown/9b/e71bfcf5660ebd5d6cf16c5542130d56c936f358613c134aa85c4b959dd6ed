I"úU<h2 id="1-ì‹¤ì‹œê°„-ì ì¬-í™˜ê²½-êµ¬ì„±">1. ì‹¤ì‹œê°„ ì ì¬ í™˜ê²½ êµ¬ì„±</h2>
<h3 id="1-hbase-ì„¤ì¹˜">1) HBase ì„¤ì¹˜</h3>
<ul>
  <li>CM í™ˆ - [ì„œë¹„ìŠ¤ ì¶”ê°€] - [HBase] ì„ íƒ - [ê³„ì†]
<img src="img/CH05/hbase%20%EC%84%A4%EC%B9%98.png" alt="" /></li>
</ul>

<p><br /></p>

<ul>
  <li>HBaseì˜ Masterì™€ RegionServer ì„¤ì¹˜ ìœ„ì¹˜ ì§€ì •</li>
  <li>Server01, Server02ë§Œ ìˆëŠ” ìƒíƒœì´ë¯€ë¡œ, ëª¨ë“  ì„¤ì¹˜ ìœ„ì¹˜ë¥¼ Server02ë¡œ ì§€ì •</li>
  <li>ì¶”ê¸°ë¡œ Thrift ServerëŠ” Server01ì— ì„¤ì¹˜í•˜ë©°, REST ì„œë²„ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
<img src="img/CH05/hbase%20%EC%82%AC%EC%9A%A9%EC%9E%90%20%EC%A7%80%EC%A0%95%20-%20server3%EA%B0%80%20%EC%97%86%EC%96%B4%EC%84%9C%20%EC%A0%84%EB%B6%80%20server2%EB%A1%9C.png" alt="" /></li>
</ul>

<p><br /></p>

<ul>
  <li>HBase Serviceì˜ ê¸°ë³¸ ì„¤ì •ê°’ ë³€ê²½</li>
  <li>HBaseì˜ í…Œì´ë¸” ë³µì œ ë° ì¸ë±ìŠ¤ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ</li>
  <li>ê¸°ë³¸ê°’ì„ ìœ ì§€í•˜ê³  [ê³„ì†] í´ë¦­</li>
</ul>

<p><br /></p>

<ul>
  <li>HBaseì˜ Thrift Http ì„œë²„ í™œì„±í™”</li>
  <li>CM í™ˆ - [HBase] - [êµ¬ì„±]</li>
  <li>â€œHBase Thrift Http ì„œë²„ ì„¤ì •â€ ê²€ìƒ‰</li>
  <li><strong>HBase(ì„œë¹„ìŠ¤ ì „ì²´)</strong> í•­ëª© ì²´í¬ í›„ [ë³€ê²½ ë‚´ìš© ì €ì¥]
<img src="img/CH05/hbase%20%EA%B5%AC%EC%84%B1%20%EB%B3%80%EA%B2%BD.png" alt="" /></li>
</ul>

<p><br /></p>

<ul>
  <li>HBase ì„œë¹„ìŠ¤ ì‹œì‘ ë˜ëŠ” ì¬ì‹œì‘</li>
  <li>ê·¸ëŸ¼ HBaseì˜ Master ì„œë²„ì™€ RegionServer ê¸°ë™ í™”ë©´ì´ í™œì„±í™”ë  ê²ƒ</li>
  <li>HBaseì²˜ëŸ¼ ê·œëª¨ê°€ ìˆëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ì„¤ì¹˜ë˜ë©´ ì´ë¯¸ ì„¤ì¹˜ëœ ì†Œí”„íŠ¸ì›¨ì–´(ì£¼í‚¤í¼, HDFS, YARN ë“±)ì˜ í´ë¼ì´ì–¸íŠ¸ ì„¤ì •ê°’ì— ë³€ë™ ë°œìƒ -&gt; í´ë¼ì´ì–¸íŠ¸ ì¬ë°°í¬ë¥¼ í†µí•´ ë³€ê²½ì‚¬í•­ ë°˜ì˜</li>
</ul>

<p><br /></p>

<ul>
  <li>HBaseê°€ ì •ìƒì ìœ¼ë¡œ ì„¤ì¹˜ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ HBase ì‰˜ì—ì„œ í…ŒìŠ¤íŠ¸ìš© í…Œì´ë¸”ì„ ë§Œë“¤ê³ , í•´ë‹¹ í…Œì´ë¸”ì— Put / Get ëª…ë ¹ ì‹¤í–‰
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hbase shell
<span class="o">&gt;</span> create <span class="s1">'smartcar_test_table'</span>, <span class="s1">'cf'</span>
<span class="o">&gt;</span> put <span class="s1">'smartcar_test_table'</span>, <span class="s1">'row-key1'</span>, <span class="s1">'cf:model'</span>, <span class="s1">'Z0001'</span>
<span class="o">&gt;</span> put <span class="s1">'smartcar_test_table'</span>, <span class="s1">'rew-key1'</span>, <span class="s1">'cf:no'</span>, <span class="s1">'12345'</span>
<span class="o">&gt;</span> get <span class="s1">'smartcar_test_table'</span>, <span class="s1">'row-key1'</span>
</code></pre></div>    </div>
    <p><img src="img/CH05/hbase%20shell%20put%2C%20get%20%ED%85%8C%EC%8A%A4%ED%8A%B8.png" alt="" /></p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># table ì‚­ì œ</span>
<span class="o">&gt;</span> disable <span class="s1">'smartcar_test_table'</span>
<span class="o">&gt;</span> drop <span class="s1">'smartcar_test_table'</span>
<span class="o">&gt;</span> <span class="nb">exit</span>
</code></pre></div></div>
<p><img src="img/CH05/hbase%20shell%20disable.png" alt="" />
<img src="img/CH05/hbase%20shell%20drop.png" alt="" /></p>

<p><br /></p>

<ul>
  <li>HBase ì›¹ ê´€ë¦¬ì í™”ë©´ì— ì ‘ì†í•˜ë©´ HBaseì˜ ë‹¤ì–‘í•œ ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŒ <br />
http://server02.hadoop.com:16010
<img src="img/CH05/hbase%20%EC%9B%B9%EA%B4%80%EB%A6%AC%EC%9E%90%20%ED%99%94%EB%A9%B4.png" alt="" /></li>
</ul>

<p><br /></p>

<ul>
  <li>HBaseëŠ” ìì› ì†Œëª¨ê°€ ë†’ì€ ì„œë²„ì´ë¯€ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šì„ ë•ŒëŠ” ì¼ì‹œ ì •ì§€</li>
</ul>

<p><br /></p>

<h3 id="2-ë ˆë””ìŠ¤-ì„¤ì¹˜">2) ë ˆë””ìŠ¤ ì„¤ì¹˜</h3>
<ul>
  <li>CMì˜ ì†Œí”„íŠ¸ì›¨ì–´ ì»´í¬ë„ŒíŠ¸ë¡œ í¬í•¨ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— ë ˆë””ìŠ¤ ì„¤ì¹˜ íŒ¨í‚¤ì§€ë¡œ Server02ì— ì§ì ‘ ì„¤ì¹˜</li>
</ul>

<p><br /></p>

<ul>
  <li>Server02ì— root ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸</li>
  <li><strong>gcc</strong>ì™€ <strong>tcl</strong> ì„¤ì¹˜</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install</span> <span class="nt">-y</span> gcc<span class="k">*</span>
yum <span class="nb">install</span> <span class="nt">-y</span> tcl
</code></pre></div></div>

<blockquote>
  <p>yum ëª…ë ¹ ì¤‘ â€œremoving mirrorlist with no valid mirrors:..â€ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ ì•„ë˜ ëª…ë ¹ ëª¨ë‘ ì‹¤í–‰</p>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"http: //vault.centos.org/6.10/os/Ã—86_64/"</span> <span class="o">&gt;</span> /var/cache/yum/x86_64/6/base/mirrorlist.txt
<span class="nb">echo</span> <span class="s2">"http://vault.centos.org/6.10/extras/x86_64/"</span> <span class="o">&gt;</span> /var/cache/yum/Ã—86_64/6/extras/mirrorlist.txt
<span class="nb">echo</span> <span class="s2">"http://vault.centos.org/6. 10/updates/x86_64/"</span> <span class="o">&gt;</span> /var/cache/yum/x86_64/6/updates/mirrorlist.txt
<span class="nb">echo</span> <span class="s2">"http://vault.centos.org/6.10/sclo/x86_64/rh"</span> â€º /var/cache/yum/Ã—86_64/6/centos-sclo-rh/mirrorlist.txt 
<span class="nb">echo</span> <span class="s2">"http://vault.centos.org/6.10/sclo/x86_64/sclo"</span> <span class="o">&gt;</span>/var/cache/yum/Ã—86_64/6/centos-sclo-sclo/mirrorlist.txt
</code></pre></div>  </div>
</blockquote>

<p><br /></p>

<ul>
  <li>ë ˆë””ìŠ¤ 5.0.7 ë‹¤ìš´ë°›ì•„ ë¹Œë“œ ë° ì„¤ì¹˜ ì§„í–‰
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/pilot-pjt
wget http://download.redis.io/releases/redis-5.0.7.tar.gz
<span class="nb">tar</span> <span class="nt">-xvf</span> redis-5.0.7.tar.gz
<span class="nb">cd</span> /home/pilot-pjt/redis-5.0.7
make
make <span class="nb">install
cd</span> /home/pilot-pjt/redis-5.0.7/utils
<span class="nb">chmod </span>75 install_server.sh
</code></pre></div>    </div>
    <p><img src="img/CH05/redis%20%EC%84%A4%EC%B9%981.png" alt="" />
<img src="img/CH05/redis%20%EC%84%A4%EC%B9%982-%20make.png" alt="" />
<img src="img/CH05/redis%20%EC%84%A4%EC%B9%983.png" alt="" /></p>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>ì¸ìŠ¤í†¨ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰</li>
  <li>ì—¬ëŸ¬ í™•ì¸ ë©”ì‹œì§€ë“¤ ëª¨ë‘ ì—”í„°í‚¤ ì…ë ¥
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./install_server.sh
</code></pre></div>    </div>
    <p><img src="img/CH05/redis%20%EC%84%A4%EC%B9%984.png" alt="" /></p>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>ë ˆë””ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì˜ í¬íŠ¸, ë¡œê·¸, ë°ì´í„° íŒŒì¼ ë“±ì˜ ì„¤ì •ê°’ ë° ìœ„ì¹˜ ì •ë³´ë¥¼ ë¬¼ì–´ë³´ë©´ ê¸°ë³¸ê°’ì„ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ê³  ì—”í„°í‚¤ ì…ë ¥</li>
  <li>ì•„ë˜ <code class="language-plaintext highlighter-rouge">vi</code> ëª…ë ¹ìœ¼ë¡œ ë ˆë””ìŠ¤ ì„œë²„ ê¸°ë™ ì—¬ë¶€ í™•ì¸
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi /var/log/redis_6379.log
</code></pre></div>    </div>
    <p><img src="img/CH05/redis%20%EC%84%9C%EB%B2%84%20%EA%B8%B0%EB%8F%99%20%EC%97%AC%EB%B6%80%20%ED%99%95%EC%9D%B8.png" alt="" /></p>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>ë ˆë””ìŠ¤ê°€ ì„±ê³µì ìœ¼ë¡œ ì„¤ì¹˜ëëŠ”ì§€ ì ê²€í•˜ê¸° ìœ„í•´ ì•„ë˜ ëª…ë ¹ ì‹¤í–‰ í›„ <code class="language-plaintext highlighter-rouge">Redis is running</code> ë©”ì‹œì§€ í™•ì¸
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>service redis_6379 status
</code></pre></div>    </div>
    <blockquote>
      <p>redis ì„œë²„ í¬íŠ¸ ê¸°ë³¸ê°’: 6379</p>
    </blockquote>
  </li>
  <li>ë ˆë””ìŠ¤ ì„œë¹„ìŠ¤ ì‹œì‘ <code class="language-plaintext highlighter-rouge">service redis_6379 start</code></li>
  <li>ë ˆë””ìŠ¤ ì„œë¹„ìŠ¤ ì¢…ë£Œ <code class="language-plaintext highlighter-rouge">service redis_6379 stop</code></li>
</ul>

<p><br /></p>

<ul>
  <li>ë ˆë””ìŠ¤ ì„œë²„ì— ì›ê²© ì ‘ê·¼ì„ í•˜ê¸° ìœ„í•´ ì„¤ì • íŒŒì¼ì„ ì—´ì–´ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •</li>
  <li>ì„¤ì • íŒŒì¼ì€ <code class="language-plaintext highlighter-rouge">/etc/redis/6379.conf</code>ì— ìœ„ì¹˜
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi /etc/redis/6379.conf
</code></pre></div>    </div>
  </li>
  <li>ë°”ì¸ë”© IP ì œí•œ í•´ì œ
    <ul>
      <li><code class="language-plaintext highlighter-rouge">bind 127.0.0.1</code> ë¶€ë¶„ ì£¼ì„ ì²˜ë¦¬</li>
    </ul>
  </li>
  <li>íŒ¨ìŠ¤ì›Œë“œ ì…ë ¥ í•´ì œ
    <ul>
      <li><code class="language-plaintext highlighter-rouge">protected-mode yes</code> ë¶€ë¶„ì„ ì°¾ì•„ <strong>yes</strong> -&gt; <strong>no</strong> ë¡œ ë³€ê²½
<img src="img/CH05/redis%20%EC%84%A4%EC%A0%95%ED%8C%8C%EC%9D%BC%20%EC%88%98%EC%A0%95.png" alt="" /></li>
    </ul>
  </li>
  <li>ë ˆë””ìŠ¤ ì„œë²„ ì¬ì‹œì‘
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>service redis_6379 restart
</code></pre></div>    </div>
  </li>
</ul>

<p><br /></p>

<ul>
  <li><strong>ë ˆë””ìŠ¤ CLIë¥¼ í†µí•´ ê°„ë‹¨íˆ ë ˆë””ìŠ¤ ì„œë²„ì— ë°ì´í„° ì €ì¥(Set) / ì¡°íšŒ(Get)</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">key:1</code>ì´ë¼ëŠ” í‚¤ë¡œ â€œHello!BigDataâ€ ê°’ì„ ë ˆë””ìŠ¤ ì„œë²„ì— ì €ì¥í•˜ê³  ë‹¤ì‹œ ì¡°íšŒ</li>
      <li>ë§ˆì§€ë§‰ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">key:1</code>ì˜ ë°ì´í„° ì‚­ì œí•˜ê³  ë ˆë””ìŠ¤ CLI ì¢…ë£Œ
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>redis-cli
<span class="o">&gt;</span> <span class="nb">set </span>key:1 Hello!BigData
<span class="o">&gt;</span> get key:1
<span class="o">&gt;</span> del key:1
<span class="o">&gt;</span> quit
</code></pre></div>        </div>
        <p><img src="img/CH05/redis%20%EC%9E%AC%EC%8B%9C%EC%9E%91%20%ED%9B%84%20cli%20%ED%85%8C%EC%8A%A4%ED%8A%B8.png" alt="" /></p>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="3-ìŠ¤í†°-ì„¤ì¹˜">3) ìŠ¤í†° ì„¤ì¹˜</h3>
<ul>
  <li>Server02ì— root ê³„ì •ìœ¼ë¡œ ì ‘ì†í•´ì„œ ìŠ¤í†° ì„¤ì¹˜ë¥¼ ìœ„í•œ tar íŒŒì¼ ë‹¤ìš´ë¡œë“œ
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/pilot-pjt
wget http://archive.apache.org/dist/storm/apache-storm-1.2.3/apache-storm-1.2.3.tar.gz
<span class="nb">tar</span> <span class="nt">-xvf</span> apache-storm-1.2.3.tar.gz
<span class="nb">ln</span> <span class="nt">-s</span> apache-storm-1.2.3 storm
</code></pre></div>    </div>
  </li>
</ul>

<p><br /></p>

<ul>
  <li><strong>ìŠ¤í†° í™˜ê²½ì„¤ì • íŒŒì¼ ìˆ˜ì •</strong></li>
  <li><code class="language-plaintext highlighter-rouge">storm.yaml</code> íŒŒì¼ ì—´ì–´ì„œ ì•„ë˜ ë‚´ìš©ê³¼ ë™ì¼í•˜ê²Œ ì…ë ¥
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/pilot-pjt/storm/conf
vi storm.yaml
</code></pre></div>    </div>
    <p>```yaml
storm.zookeeper.servers:</p>
  </li>
  <li>â€œserver02.hadoop.comâ€</li>
</ul>

<p>storm.local.dir: â€œ/home/pilot-pjt/storm/dataâ€</p>

<p>nimbus.seeds: [â€œserver02.hadoop.comâ€]</p>

<p>supervisor.slots.ports:</p>
<ul>
  <li>6700</li>
</ul>

<p>ui.port: 8088</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>![](img/CH05/storm.yaml%20%ED%8C%8C%EC%9D%BC%20%EC%88%98%EC%A0%95.png)

- 5ê°œì˜ ìŠ¤í†° ì„¤ì •ê°’
    - ì£¼í‚¤í¼ ì •ë³´
    - ìŠ¤í†°ì´ ì‘ë™í•˜ëŠ” ë° í•„ìš”í•œ ë°ì´í„° ì €ì¥ì†Œ
    - ìŠ¤í†°ì˜ Nimbus ì •ë³´
    - Workerì˜ í¬íŠ¸ë¡œì„œ, í¬íŠ¸ì˜ ê°œìˆ˜ë§Œí¼ ë©€í‹° Workerê°€ ë§Œë“¤ì–´ì§
        - íŒŒì¼ëŸ¿ í”„ë¡œì íŠ¸ì—ì„œëŠ” 6700ë²ˆ í¬íŠ¸ì˜ ë‹¨ì¼ ì›Œì»¤ë§Œ ì‘ë™
    - ë§ˆì§€ë§‰ìœ¼ë¡œ ìŠ¤í†° UI ì ‘ì† í¬íŠ¸ ì„¤ì •

&lt;br&gt;

- **ìŠ¤í†°ì˜ ë¡œê·¸ ë ˆë²¨ ì¡°ì •**
- ê¸°ë³¸ê°’ì¸ "info"ë¡œ ë˜ì–´ìˆëŠ”ë°, ìŠ¤í†°ì—ì„œëŠ” ëŒ€ê·œëª¨ íŠ¸ëœì­ì…˜ ë°ì´í„°ê°€ ìœ ì…ë˜ë©´ì„œ ê³¼ë„í•œ ë¡œê·¸ë¡œ ì¸í•´ ì„±ëŠ¥ ì €í•˜ì™€ ë””ìŠ¤í¬ ê³µê°„ ë¶€ì¡±ì´ ë°œìƒí•  ìˆ˜ ìˆìŒ
- ì´ ê°™ì€ ë¬¸ì œë¥´ ë°©ì§€í•˜ê¸° ìœ„í•´ ë‘ ê°œì˜ íŒŒì¼ ìˆ˜ì •
    - cluster.zml , worker.xml íŒŒì¼
    - 75ë²ˆì§¸ ì¤„ê³¼ 91ë²ˆì§¸ ì¤„ ì‚¬ì´ì˜  logger ì„¤ì •ì—ì„œ `level="info"` -&gt; `level="error`ë¡œ ëª¨ë‘ ë³€ê²½

```bash
cd /home/pilot-pjt/storm/long4j2
vi cluster.xml
vi worker.xml
</code></pre></div></div>
<p><img src="img/CH05/storm%20%EB%A1%9C%EA%B7%B8%20%EB%A0%88%EB%B2%A8%20%EC%A1%B0%EC%A0%95.png" alt="" /></p>

<p><br /></p>

<ul>
  <li><strong>root ê³„ì •ì˜ í”„ë¡œíŒŒì¼ì˜ ìŠ¤í†° path ì„¤ì •</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi /root/.bash_profile
</code></pre></div>    </div>
  </li>
  <li><code class="language-plaintext highlighter-rouge">/home/pilot-pjt/storm/bin</code> ê²½ë¡œ ì¶”ê°€</li>
</ul>

<p><img src="img/CH05/strom%20path%20%EC%84%A4%EC%A0%95.png" alt="" /></p>

<ul>
  <li><strong>ìˆ˜ì •í•œ root ê³„ì •ì˜ í”„ë¡œíŒŒì¼ ì •ë³´ ë‹¤ì‹œ ì½ì–´ì˜´</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> /root/.bash_profile
</code></pre></div>    </div>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>CH02ì—ì„œ ì„¤ì •í–ˆë˜ ìë°” ëª…ë ¹ì˜ ë§í¬ ì •ë³´ê°€ ë³€ê²½ë˜ëŠ” ê²½ìš°ê°€ ìˆìŒ</li>
  <li><code class="language-plaintext highlighter-rouge">java -version</code>ì„ ì‹¤í–‰í•œ í›„, â€˜1.8.xâ€™ê°€ ì•„ë‹ˆë©´ ì•„ë˜ ëª…ë ¹ì„ í†µí•´ JDK 1.8 ë§í¬ë¡œ ë³€ê²½
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> /usr/bin/java
<span class="nb">rm</span> /usr/bin/javac
<span class="nb">ln</span> <span class="nt">-s</span> /usr/java/jdk1.8.0_181-cloudera/bin/javac /usr/bin/javac
<span class="nb">ln</span> <span class="nt">-s</span> /usr/java/jdk1.8.0_181-cloudera/bin/java /usr/bin/java
</code></pre></div>    </div>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>ê¸°ë³¸ì ì¸ ìŠ¤í†° ì„¤ì¹˜ ì™„ë£Œ</li>
  <li>ë¦¬ëˆ…ìŠ¤ê°€ ì¬ì‹œì‘í•  ë•Œë„ ìŠ¤í†°ì´ ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ë„ë¡ ì„¤ì •</li>
  <li><code class="language-plaintext highlighter-rouge">storm-nimbus</code>, <code class="language-plaintext highlighter-rouge">storm-supervisor</code>, <code class="language-plaintext highlighter-rouge">storm-ui</code> 3ê°œì˜ ìŠ¤í†° ì„œë¹„ìŠ¤ê°€ ìˆê³ , 3ê°œì˜ ìë™ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ í•„ìš”</li>
  <li>íŒŒì¼ì§ˆë¼ ì´ìš©í•´ì„œ sever02ì— 3ê°œì˜ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
<img src="img/CH05/%EC%8A%A4%ED%86%B0%20%EC%84%9C%EB%B9%84%EC%8A%A4%20%EC%9E%90%EB%8F%99%20%EC%8B%A4%ED%96%89%20%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%20%EC%97%85%EB%A1%9C%EB%93%9C.png" alt="" /></li>
</ul>

<p><br /></p>

<ul>
  <li><strong>ì—…ë¡œë“œí•œ ì„¸ íŒŒì¼ì˜ ê¶Œí•œ ë³€ê²½</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod </span>755 /etc/rc.d/init.d/storm-nimbus
<span class="nb">chmod </span>755 /etc/rc.d/init.d/storm-supervisor
<span class="nb">chmod </span>755 /etc/rc.d/init.d/storm-ui
</code></pre></div>    </div>
    <p><img src="img/CH05/storm%20%EC%9E%90%EB%8F%99%EC%8B%A4%ED%96%89%20%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%20%ED%8C%8C%EC%9D%BC%20%EA%B6%8C%ED%95%9C%20%EB%B3%80%EA%B2%BD.png" alt="" /></p>
  </li>
</ul>

<p><br /></p>

<ul>
  <li><strong>ì„œë¹„ìŠ¤ ë“±ë¡ ìŠ¤í¬ë¦½íŠ¸ì— ëŒ€í•œ Log ë° Pid ë””ë ‰í„°ë¦¬ ìƒì„±</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> /var/log/storm
<span class="nb">mkdir</span> /var/run/storm
</code></pre></div>    </div>
    <p><img src="img/CH05/%EC%84%9C%EB%B9%84%EC%8A%A4%20%EB%93%B1%EB%A1%9D%20%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EC%97%90%20%EB%8C%80%ED%95%9C%20%EB%94%94%EB%A0%89%ED%84%B0%EB%A6%AC.png" alt="" /></p>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>**ì„¸ íŒŒì¼ì— ëŒ€í•´ ì•„ë˜ì˜ service/chkconfig ë“±ë¡ ëª…ë ¹ ê°ê° ì‹¤í–‰
```bash</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;br&gt;

- **ì•„ë˜ ëª…ë ¹ìœ¼ë¡œ ìŠ¤í†°ì´ ì •ìƒì ìœ¼ë¡œ êµ¬ë™ëëŠ”ì§€ í™•ì¸**
```bash
service storm-nimbus status
service storm-supervisor status
service storm-ui status
</code></pre></div></div>
<ul>
  <li>ëª¨ë‘ <code class="language-plaintext highlighter-rouge">...is running</code> ìƒíƒœì¸ì§€ í™•ì¸
    <blockquote>
      <p>ì£¼ì˜) ìŠ¤í†°ì€ ì£¼í‚¤í¼ì— ì˜ì¡´ë„ê°€ ë†’ê¸° ë•Œë¬¸ì—, ìŠ¤í†°ì„ ì‚¬ìš©í•  ë• ë°˜ë“œì‹œ ì£¼í‚¤í¼ì˜ ìƒíƒœë¥¼ í™•ì¸í•´ì•¼ í•¨!</p>
    </blockquote>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>ìŠ¤í†° UIì— ì ‘ì†í•´ì„œ ìŠ¤í†°ì˜ ì¤‘ìš” ìƒíƒœë“¤ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŒ <br />
http://server02.hadoop.com:8088
<img src="img/CH05/storm%20ui.png" alt="" /></li>
</ul>

<p><br /></p>

<h2 id="2-ì‹¤ì‹œê°„-ì ì¬-ê¸°ëŠ¥-êµ¬í˜„">2. ì‹¤ì‹œê°„ ì ì¬ ê¸°ëŠ¥ êµ¬í˜„</h2>
<ul>
  <li>ìŠ¤í†°ì˜ Spoutê³¼ Boltì˜ í”„ë¡œê·¸ë¨ êµ¬í˜„ ë‹¨ê³„</li>
  <li>ìš´ì „ìì˜ ìš´í–‰ ì •ë³´ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¹´í”„ì¹´ì— ì ì¬ë˜ê³ , ì´ë¥¼ ìŠ¤í†°ì˜ Spoutê°€ ì½ì–´ì„œ Boltë¡œ ì „ë‹¬</li>
  <li>ì•„ë˜ ê·¸ë¦¼ì€ íŒŒì¼ëŸ¿ í”„ë¡œì íŠ¸ì—ì„œ ì‹¤ì‹œê°„ ì²˜ë¦¬ì™€ ì ì¬ë¥¼ ìœ„í•œ ìŠ¤í†° Topology</li>
  <li>Topology ì•ˆì˜ 5ê°œ ì»´í¬ë„ŒíŠ¸ëŠ” ëª¨ë‘ ìë°” í”„ë¡œê·¸ë¨ì´ë©°, í•´ë‹¹ í”„ë¡œê·¸ë¨ì„ í†µí•´ ì‹¤ì‹œê°„ ì ì¬ ê¸°ëŠ¥ êµ¬í˜„
<img src="img/CH05/%EC%8B%A4%EC%8B%9C%EA%B0%84%EC%A0%81%EC%9E%AC%EA%B8%B0%EB%8A%A5.png" alt="" /></li>
</ul>

<p><br /></p>

<blockquote>
  <p><strong>ìš©ì–´ ì •ë¦¬</strong> <br />
<code class="language-plaintext highlighter-rouge">table</code>: HBaseëŠ” ë°ì´í„°ë¥¼ í…Œì´ë¸”ì— ì¡°ì§í™”. ì—¬ëŸ¬ ê°œì˜ ë¡œìš°ë¡œ êµ¬ì„±ëœ ì§‘í•©   <br />
<code class="language-plaintext highlighter-rouge">row</code>: í…Œì´ë¸” ë‚´ì— ìˆê³ , ë°ì´í„°ëŠ” í…Œì´ë¸”ì˜ ë¡œìš°ì— ë”°ë¼ ì €ì¥ë¨. ë¡œìš°ëŠ” ë¡œìš°í‚¤ì™€ í•œ ê°œ ì´ìƒì˜ ì¹¼ëŸ¼ê³¼ ê°’ìœ¼ë¡œ êµ¬ì„±ë¨.  <br />
<code class="language-plaintext highlighter-rouge">row key</code>: ë¡œìš°ëŠ” ë¡œìš°í‚¤ì— ì˜í•´ ìœ ì¼í•˜ê²Œ ì‹ë³„ë¨   <br />
<code class="language-plaintext highlighter-rouge">column</code>: HBase ì¹¼ëŸ¼ì€ column familyì™€ column qualifierë¡œ êµ¬ì„±ë¨ <br />
<code class="language-plaintext highlighter-rouge">ì¹¼ëŸ¼ íŒ¨ë°€ë¦¬</code>: ë¡œìš° ë‚´ì— ìˆëŠ” ë°ì´í„°ëŠ” ì¹¼ëŸ¼ íŒ¨ë°€ë¦¬ì— ì˜í•´ ê·¸ë£¹í™”ë¨. ë˜í•œ, HBase ë‚´ì˜ ë°ì´í„° ì €ì¥ì„ ìœ„í•œ ë¬¼ë¦¬ì  ì²˜ë¦¬ ë°©ì‹ì— ì˜í–¥ì„ ì¤Œ.</p>
</blockquote>

<p><br /></p>

<h3 id="1-ì¹´í”„ì¹´-spout-ê¸°ëŠ¥-êµ¬í˜„">1) ì¹´í”„ì¹´ Spout ê¸°ëŠ¥ êµ¬í˜„</h3>
<ul>
  <li>ìŠ¤í†° Spoutì˜ ê¸°ë³¸ ê¸°ëŠ¥ì€ ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ì˜ ì—°ë™ì„ í†µí•´ ìŠ¤í†°ì˜ Topologyë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒ</li>
  <li>íŒŒì¼ëŸ¿ í”Œì ì—ì„œëŠ” ì¹´í”„ì¹´ì— ì ì¬ëœ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ <strong>ì¹´í”„ì¹´-Spout</strong>ì„ ì‚¬ìš©</li>
  <li>ì¹´í”„ì¹´ Spoutì€ ì¹´í”„ì¹´ë¡œë¶€í„° ìˆ˜ì‹ ë°›ì€ ë°ì´í„°ë¥¼ ë‘ ê°œì˜ Bolt(Split/Esper)ì— ë¼ìš°íŒ…</li>
</ul>

<p><br /></p>

<ul>
  <li><strong>ì¹´í”„ì¹´ Spout ìƒì„± - SmartCarDriverTopology.java</strong>
```java
package com.wikibook.bigdata.smartcar.storm;</li>
</ul>

<p>import java.io.IOException;
import java.util.Arrays;
import java.util.Map;
import java.util.UUID;</p>

<p>import org.apache.storm.guava.collect.Maps;
import org.apache.storm.redis.common.config.JedisPoolConfig;</p>

<p>import storm.kafka.BrokerHosts;
import storm.kafka.KafkaSpout;
import storm.kafka.SpoutConfig;
import storm.kafka.StringScheme;
import storm.kafka.ZkHosts;
import backtype.storm.Config;
import backtype.storm.StormSubmitter;
import backtype.storm.generated.AlreadyAliveException;
import backtype.storm.generated.InvalidTopologyException;
import backtype.storm.generated.StormTopology;
import backtype.storm.spout.Scheme;
import backtype.storm.spout.SchemeAsMultiScheme;
import backtype.storm.topology.TopologyBuilder;</p>

<p>public class SmartCarDriverTopology {</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public static void main(String[] args) throws AlreadyAliveException, InvalidTopologyException, InterruptedException, IOException {  

	StormTopology topology = makeTopology();

	Map&lt;String, String&gt; HBaseConfig = Maps.newHashMap();
	HBaseConfig.put("hbase.rootdir","hdfs://server01.hadoop.com:8020/hbase");

	Config config = new Config();
	config.setDebug(true);
	config.put("HBASE_CONFIG",HBaseConfig);

	config.put(Config.NIMBUS_HOST, "server01.hadoop.com");
	config.put(Config.NIMBUS_THRIFT_PORT, 6627);
	config.put(Config.STORM_ZOOKEEPER_PORT, 2181);
	config.put(Config.STORM_ZOOKEEPER_SERVERS, Arrays.asList("server02.hadoop.com"));

	StormSubmitter.submitTopology(args[0], config, topology);
}  

private static StormTopology makeTopology() {
    
    // â“µ
	String zkHost = "server02.hadoop.com:2181";
	TopologyBuilder driverCarTopologyBuilder = new TopologyBuilder();
	
	// Spout Bolt
	BrokerHosts brkBost = new ZkHosts(zkHost);
	String topicName = "SmartCar-Topic";
	String zkPathName = "/SmartCar-Topic";

    // â“¶
	SpoutConfig spoutConf = new SpoutConfig(brkBost, topicName, zkPathName, UUID.randomUUID().toString());
	spoutConf.scheme = new SchemeAsMultiScheme(new StringScheme());
	KafkaSpout kafkaSpout = new KafkaSpout(spoutConf);
	
    // â“·
	driverCarTopologyBuilder.setSpout("kafkaSpout", kafkaSpout, 1);
	
    // â“¸
	// Grouping - SplitBolt &amp; EsperBolt
	driverCarTopologyBuilder.setBolt("splitBolt", new SplitBolt(),1).allGrouping("kafkaSpout");
	driverCarTopologyBuilder.setBolt("esperBolt", new EsperBolt(),1).allGrouping("kafkaSpout");
	
	// HBase Bolt
	TupleTableConfig hTableConfig = new TupleTableConfig("DriverCarInfo", "r_key");
	hTableConfig.setZkQuorum("server02.hadoop.com");
	hTableConfig.setZkClientPort("2181");
	hTableConfig.setBatch(false);
	hTableConfig.addColumn("cf1", "date");
	hTableConfig.addColumn("cf1", "car_number");
	hTableConfig.addColumn("cf1", "speed_pedal");
	hTableConfig.addColumn("cf1", "break_pedal");
	hTableConfig.addColumn("cf1", "steer_angle");
	hTableConfig.addColumn("cf1", "direct_light");
	hTableConfig.addColumn("cf1", "speed");
	hTableConfig.addColumn("cf1", "area_number");
	
	HBaseBolt hbaseBolt = new HBaseBolt(hTableConfig);
	driverCarTopologyBuilder.setBolt("HBASE", hbaseBolt, 1).shuffleGrouping("splitBolt");
	
	// Redis Bolt
	String redisServer = "server02.hadoop.com";
	int redisPort = 6379;
	JedisPoolConfig jedisPoolConfig = new JedisPoolConfig.Builder().setHost(redisServer).setPort(redisPort).build();
	RedisBolt redisBolt = new RedisBolt(jedisPoolConfig);
	
	driverCarTopologyBuilder.setBolt("REDIS", redisBolt, 1).shuffleGrouping("esperBolt");

	return driverCarTopologyBuilder.createTopology();
} }   ```
</code></pre></div></div>

<ul>
  <li>â“µ
    <ul>
      <li>ì¹´í”„ì¹´ì— ì ‘ì†í•˜ê¸° ìœ„í•œ ì„œë²„ì™€ í† í”½ ì •ë³´ë¥¼ ì •ì˜</li>
      <li>KafkaSpoutì´ ì‘ë™í•˜ëŠ” Workerì˜ êµ¬ì„± ì •ë³´ ì„¤ì •</li>
    </ul>
  </li>
  <li>â“¶
    <ul>
      <li>KafkaSpout ê°ì²´ ìƒì„±</li>
      <li>ì£¼í‚¤í¼ ì„œë²„ ì •ë³´, ì¹´í”„ì¹´ í† í”½ ì •ë³´, ë©”ì‹œì§€ í˜•ì‹, ë©”ì‹œì§€ ìˆ˜ì‹  ë°©ì‹ ë“± ì„¤ì •</li>
    </ul>
  </li>
  <li>â“·
    <ul>
      <li>KafkaSpout ê°ì²´ë¥¼ ìŠ¤í†°ì˜ Topologyì— ì„¤ì •</li>
      <li>â€˜ê³ ìœ  IDâ€™, â€˜Kafka Spout ê°ì²´, â€˜ë³‘ë ¬ ì²˜ë¦¬ íŒíŠ¸â€™ ì„¤ì •</li>
    </ul>
  </li>
  <li>â“¸
    <ul>
      <li>KafkaSpoutê°€ ìˆ˜ì‹ ë°›ì€ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ë¼ìš°íŒ…í• ì§€ì— ëŒ€í•œ ì„¤ì •</li>
      <li>ìŠ¤í†° Topologyì˜ ê·¸ë£¨í•‘ ì„¤ì •ìœ¼ë¡œ All-Grouping ê¸°ëŠ¥ì„ ì´ìš©í•´ ì•ì„œ ì„¤ì •í•œ â€œKafkaSpoutâ€ë¡œë¶€í„° ë°›ì€ ë°ì´í„°ë¥¼ ë‘ ê°œì˜ Bolt(Split/Esper)ì— ë™ì¼í•˜ê²Œ ì „ë‹¬</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="2-split-bolt-ê¸°ëŠ¥-êµ¬í˜„">2) Split Bolt ê¸°ëŠ¥ êµ¬í˜„</h3>
<ul>
  <li>Split BoltëŠ” ì¹´í”„ì¹´-Spoutìœ¼ë¡œë¶€í„° ì „ë‹¬ë°›ì€ ë©”ì‹œì§€ë¥¼ HBaseì˜ ì¹¼ëŸ¼ í•„ë“œ ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•˜ê¸° ìœ„í•œ ì‘ì—… ìˆ˜í–‰</li>
</ul>

<p><br /></p>

<ul>
  <li><strong>Split Bolt ì†ŒìŠ¤ - SplitBolt.java</strong>
```java
package com.wikibook.bigdata.smartcar.storm;</li>
</ul>

<p>import backtype.storm.topology.BasicOutputCollector;
import backtype.storm.topology.OutputFieldsDeclarer;
import backtype.storm.topology.base.BaseBasicBolt;
import backtype.storm.tuple.Fields;
import backtype.storm.tuple.Tuple;
import backtype.storm.tuple.Values;</p>

<p>public class SplitBolt extends BaseBasicBolt{</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private static final long serialVersionUID = 1L;

public void execute(Tuple tuple, BasicOutputCollector collector) {

	String tValue = tuple.getString(0);  

    // â“µ
    // ë°œìƒì¼ì‹œ(14ìë¦¬), ì°¨ëŸ‰ë²ˆí˜¸, ê°€ì†í˜ë‹¬, ë¸Œë ˆì´í¬í˜ë‹¬, ìš´ì „ëŒ€íšŒì ê°, ë°©í–¥ì§€ì‹œë“±, ì£¼í–‰ì†ë„, ë®¤ì§ë²ˆí˜¸
	String[] receiveData = tValue.split("\\,");
	
    // â“¶
	collector.emit(new Values(	new StringBuffer(receiveData[0]).reverse() + "-" + receiveData[1]  , 
								receiveData[0], receiveData[1], receiveData[2], receiveData[3],
								receiveData[4], receiveData[5], receiveData[6], receiveData[7]));

}

public void declareOutputFields(OutputFieldsDeclarer declarer) {
    // â“·
	declarer.declare(new Fields("r_key"			, "date"		, "car_number", 
								"speed_pedal"	, "break_pedal"	, "steer_angle", 
								"direct_light"	, "speed"		, "area_number"));
}
</code></pre></div></div>

<p>}</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
- â“µ
    - KafkaSpoutì—ì„œ ì „ë‹¬í•œ ë°ì´í„°ê°€ íŠœí”Œ í˜•ì‹ìœ¼ë¡œ ìˆ˜ì‹ ë¨
    - ê·¸ë¦¬ê³  íŠœí”Œì— ë“¤ì–´ìˆëŠ” ë°ì´í„°ë¥¼ `,` ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•´ì„œ ë°°ì—´ì— ë‹´ìŒ
    - ìŠ¤í†°ì˜ ë©”ì‹œì§€ ë‹¨ìœ„ í•˜ë‚˜ë¥¼ **íŠœí”Œ**ì´ë¼ê³  í•˜ëŠ”ë°, ê° ìŠ¤í†°ì˜ ë ˆì´ì–´ ê°„(Spout -&gt; Bolt, Bolt -&gt; Bolt ë“±) ë©”ì‹œì§€ ì „ë‹¬ ë‹¨ìœ„ë¡œ ìƒê°í•˜ë©´ ë¨
- â“¶
    - ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ìì˜ ì‹¤ì‹œê°„ ìš´í–‰ ì •ë³´ ë°ì´í„°ì…‹ì˜ í˜•ì‹ ì •ì˜
    - í•´ë‹¹ ë°ì´í„°ë¥¼ ë°°ì—´ë¡œ êµ¬ì¡°í™”í•˜ê³ , ë°ì´í„°ë¥¼ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì „ì†¡
    - ë¹…ë°ì´í„°ì˜ ë¹„ì •í˜• ë¡œê·¸ ë°ì´í„°ê°€ ì •í˜• ë°ì´í„°ë¡œ ë³€í™˜ë˜ëŠ” ê³¼ì •ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆìŒ
- â“·
    - â“¶ì—ì„œ ì„¤ì •í•œ 9ê°œì˜ ê°’ê³¼ ìˆœì„œë³„ë¡œ ì¼ì¹˜í•˜ëŠ” í•„ë“œëª…ì€ ë‹¤ìŒê³¼ ê°™ìŒ
    - **r_key**: HBase í…Œì´ë¸”ì—ì„œ ì‚¬ìš©í•  ë¡œìš°í‚¤
    - **date**: ìš´í–‰ ë°ì´í„° ë°œìƒ ì¼ì‹œ
    - **car_num**: ìŠ¤ë§ˆíŠ¸ì¹´ì˜ ê³ ìœ  ì°¨ëŸ‰ ë²ˆí˜¸
    - **speed_pedal**: ê³¼ì† í˜ë‹¬ ë‹¨ê³„
    - **break_pedal**: ë¸Œë ˆì´í¬ í˜ë‹¬ ë‹¨ê³„
    - **steer_angle**: ìš´ì „ëŒ€ íšŒì „ ê°ë„
    - **direct_light**: ë°©í–¥ ì§€ì‹œë“±
    - **speed**: ì°¨ëŸ‰ ì†ë„
    - **area**: ì°¨ëŸ‰ ìš´í–‰ ì§€ì—­

&lt;br&gt;

- ì—¬ê¸°ì„œ **r_key**ëŠ” HBase í…Œì´ë¸”ì—ì„œ ë¡œìš°í‚¤ë¡œ í™œìš©ë˜ëŠ” ì¤‘ìš” í•„ë“œë¡œ, `date + car_num`ì„ ì¡°í•©í•œ ê°’
- ì´ë•Œ `date`ì—ëŠ” íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ **ë’¤ì§‘ì€ ê°’**ì´ ë§¤í•‘ë¨
    - ex) '20160124134517' -&gt; '71543152106102'
    - HBaseì— ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ ë¡œìš°í‚¤ì˜ HexString ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì €ì¥í•  Regionì„ ê²°ì •í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ ë•Œë¬¸
    - íŒŒì¼ëŸ¿ í”Œì ì—ì„œ ì‚¬ìš©í•  ë¡œìš°í‚¤ëŠ” ë™ì¼íŒ¨í„´ `20160125XXXXXX + ì°¨ëŸ‰ë²ˆí˜¸`ì˜ ê°’ì´ ì§€ì†ì ìœ¼ë¡œ ìƒì„±ë˜ë©°, ë¡œìš°í‚¤ì˜ ìœ ì‚¬ HexString ê°’ì´ ë§Œë“¤ì–´ì ¸ íŠ¹ì • Regionìœ¼ë¡œë§Œ ë¶€í•˜ê°€ ì§‘ì¤‘ë˜ëŠ” ë¬¸ì œ ë°œìƒ
    - í•¸ë“œí° ë²ˆí˜¸(010-XXXX-XXXX)ë‚˜ ìœ„ì¹˜ ì •ë³´(GPS, IP) ë“±ì„ ë¡œìš°í‚¤ë¡œ í™œìš©í•  ë•Œë„ ì£¼ì˜í•´ì•¼ í•¨)
    - ë˜í•œ, Regionì€ íŠ¹ì • í¬ê¸°ê°€ ë˜ë©´ ìë™ ë¶„í• ë˜ëŠ”ë°, ì´ë•Œ ì„œë¹„ìŠ¤ê°€ ì¼ì‹œ ì¤‘ë‹¨ë˜ëŠ” í˜„ìƒì´ ë°œìƒí•˜ê¸°ë„ í•¨
    - ì´ ê°™ì€ ë¬¸ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ 
        - HBase í…Œì´ë¸”ì„ ìƒì„±í•  ë•Œ ì‚¬ìš©í•  Regionì„ ë¯¸ë¦¬ ìŠ¤í”Œë¦¿(Pre-Split)í•´ì„œ ì—¬ëŸ¬ ê°œì˜ RegionServerì— ë¶„ë¦¬ ìƒì„±í•´ë†“ìŒ
        - ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ ë¡œìš°í‚¤ë¥¼ ë¦¬ë²„ìŠ¤í•´ HexString ì‹œì‘ê°’ì„ ë‹¤ì–‘í•˜ê²Œ ë°œìƒì‹œí‚´
        - ì—¬ëŸ¬ RegionServerë¡œ ë¶€í•˜ë¥¼ ë¶„ì‚°ì‹œí‚´ìœ¼ë¡œì¨ ì €ì¥ ì†ë„ ê·¹ëŒ€í™”
- ì´ì™€ ê°™ì€ HBase ë¡œìš°í‚¤ ë©”ì»¤ë‹ˆì¦˜ì€ ë°ì´í„° ì„¤ê³„ ë‹¨ê³„ì—ì„œë¶€í„° ì¤‘ìš”í•˜ê²Œ ê²€í† í•´ì•¼ í•  ì‚¬í•­!

&lt;br&gt;

### 3) HBase Bolt ê¸°ëŠ¥ êµ¬í˜„
- HBase BoltëŠ” ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ìì˜ ëª¨ë“  ìš´í–‰ ë°ì´í„°ë¥¼ ìµœì¢…ì ìœ¼ë¡œ ì ì¬í•˜ëŠ” ê¸°ëŠ¥ ìˆ˜í–‰
- ì•ì„œ Split Boltê°€ ë¶„ë¦¬í•œ í•„ë“œëª…ì„ HBaseì˜ í…Œì´ë¸” ì¹¼ëŸ¼ëª…ê³¼ ì¼ì¹˜ì‹œì¼œ ì¹¼ëŸ¼ ë‹¨ìœ„ë¡œ ì €ì¥
- HBase Boltë„ HBaseì˜ ë°ì´í„°ë¥¼ ì ì¬í•˜ê¸° ìœ„í•´ HBaseì— ì—°ê²°ëœ **ì£¼í‚¤í¼ì˜ ì—°ê²° ì •ë³´**ê°€ í•„ìš”í•˜ë©°, ì €ì¥í•˜ê³ ì í•˜ëŠ” **í…Œì´ë¸”ì˜ ë¡œìš°í‚¤**ì™€ **ì¹¼ëŸ¼ íŒ¨ë°€ë¦¬ ì •ë³´**ë„ ì•Œê³ ìˆì–´ì•¼ í•¨

&lt;br&gt;

- **HBase Bolt ìƒì„± - SmartCarDriverTopology.java**
```java
package com.wikibook.bigdata.smartcar.storm;

import java.io.IOException;
import java.util.Arrays;
import java.util.Map;
import java.util.UUID;

import org.apache.storm.guava.collect.Maps;
import org.apache.storm.redis.common.config.JedisPoolConfig;

import storm.kafka.BrokerHosts;
import storm.kafka.KafkaSpout;
import storm.kafka.SpoutConfig;
import storm.kafka.StringScheme;
import storm.kafka.ZkHosts;
import backtype.storm.Config;
import backtype.storm.StormSubmitter;
import backtype.storm.generated.AlreadyAliveException;
import backtype.storm.generated.InvalidTopologyException;
import backtype.storm.generated.StormTopology;
import backtype.storm.spout.Scheme;
import backtype.storm.spout.SchemeAsMultiScheme;
import backtype.storm.topology.TopologyBuilder;

public class SmartCarDriverTopology {


	public static void main(String[] args) throws AlreadyAliveException, InvalidTopologyException, InterruptedException, IOException {  

		StormTopology topology = makeTopology();

		Map&lt;String, String&gt; HBaseConfig = Maps.newHashMap();
		HBaseConfig.put("hbase.rootdir","hdfs://server01.hadoop.com:8020/hbase");

		Config config = new Config();
		config.setDebug(true);
		config.put("HBASE_CONFIG",HBaseConfig);

		config.put(Config.NIMBUS_HOST, "server01.hadoop.com");
		config.put(Config.NIMBUS_THRIFT_PORT, 6627);
		config.put(Config.STORM_ZOOKEEPER_PORT, 2181);
		config.put(Config.STORM_ZOOKEEPER_SERVERS, Arrays.asList("server02.hadoop.com"));

		StormSubmitter.submitTopology(args[0], config, topology);
	}  

	private static StormTopology makeTopology() {
		String zkHost = "server02.hadoop.com:2181";
		TopologyBuilder driverCarTopologyBuilder = new TopologyBuilder();
		
		// Spout Bolt
		BrokerHosts brkBost = new ZkHosts(zkHost);
		String topicName = "SmartCar-Topic";
		String zkPathName = "/SmartCar-Topic";

		SpoutConfig spoutConf = new SpoutConfig(brkBost, topicName, zkPathName, UUID.randomUUID().toString());
		spoutConf.scheme = new SchemeAsMultiScheme(new StringScheme());
		KafkaSpout kafkaSpout = new KafkaSpout(spoutConf);
		
		driverCarTopologyBuilder.setSpout("kafkaSpout", kafkaSpout, 1);
		
		// Grouping - SplitBolt &amp; EsperBolt
		driverCarTopologyBuilder.setBolt("splitBolt", new SplitBolt(),1).allGrouping("kafkaSpout");
		driverCarTopologyBuilder.setBolt("esperBolt", new EsperBolt(),1).allGrouping("kafkaSpout");
		
        // â“µ
		// HBase Bolt
		TupleTableConfig hTableConfig = new TupleTableConfig("DriverCarInfo", "r_key");
		hTableConfig.setZkQuorum("server02.hadoop.com");
		hTableConfig.setZkClientPort("2181");
		hTableConfig.setBatch(false);
		hTableConfig.addColumn("cf1", "date");
		hTableConfig.addColumn("cf1", "car_number");
		hTableConfig.addColumn("cf1", "speed_pedal");
		hTableConfig.addColumn("cf1", "break_pedal");
		hTableConfig.addColumn("cf1", "steer_angle");
		hTableConfig.addColumn("cf1", "direct_light");
		hTableConfig.addColumn("cf1", "speed");
		hTableConfig.addColumn("cf1", "area_number");
		
        // â“¶
		HBaseBolt hbaseBolt = new HBaseBolt(hTableConfig);

        // â“·
		driverCarTopologyBuilder.setBolt("HBASE", hbaseBolt, 1).shuffleGrouping("splitBolt");
		
		// Redis Bolt
		String redisServer = "server02.hadoop.com";
		int redisPort = 6379;
		JedisPoolConfig jedisPoolConfig = new JedisPoolConfig.Builder().setHost(redisServer).setPort(redisPort).build();
		RedisBolt redisBolt = new RedisBolt(jedisPoolConfig);
		
		driverCarTopologyBuilder.setBolt("REDIS", redisBolt, 1).shuffleGrouping("esperBolt");

		return driverCarTopologyBuilder.createTopology();
	}
}  
</code></pre></div></div>

<ul>
  <li>â“µ
    <ul>
      <li>HBaseì˜ ë°ì´í„°ë¥¼ ì ì¬í•˜ê¸° ìœ„í•œ Config ì •ë³´ ì„¤ì •</li>
      <li><strong>DriverCarInfo</strong>í…Œì´ë¸”ì— <code class="language-plaintext highlighter-rouge">r_key</code>ë¥¼ ë¡œìš°í‚¤ë¡œ ì •ì˜</li>
      <li>ì¹¼ëŸ¼ íŒ¨ë°€ë¦¬ <code class="language-plaintext highlighter-rouge">cf1</code>ì— í•´ë‹¹í•˜ëŠ” 8ê°œì˜ ì¹¼ëŸ¼ëª… (date, car_number, speed_pedal, break_pedal, steer_angle, direct_light, speed, area_number)ì˜ ì •ë³´ì™€ Zookeeper ì—°ê²° ì •ë³´ë„ ì •ì˜</li>
    </ul>
  </li>
  <li>â“¶
    <ul>
      <li>ì„¤ì •í•œ HBaseì˜ Config ì •ë³´(hTableConfig)ë¥¼ ì´ìš©í•´ HBaseBolt ê°ì²´ ìƒì„±</li>
    </ul>
  </li>
  <li>â“·
    <ul>
      <li>HBaseBolt ê°ì²´ë¥¼ ìŠ¤í†°ì˜ Topologyì— ì„¤ì •</li>
      <li>â€˜ê³ ìœ  IDâ€™, â€˜HBaseBolt ê°ì²´â€™, â€˜ë³‘ë ¬ ì²˜ë¦¬ íŒíŠ¸â€™ ì„¤ì •</li>
      <li>SplitBoltë¡œë¶€í„° ë°ì´í„°ë¥¼ ì „ë‹¬ë°›ê¸° ìœ„í•´ ê·¸ë£¨í•‘ëª…ì„ SplitBoltì˜ IDì¸ <code class="language-plaintext highlighter-rouge">splitBolt</code>ë¡œ ì„¤ì •</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="4-ì—ìŠ¤í¼-bolt-ê¸°ëŠ¥-êµ¬í˜„">4) ì—ìŠ¤í¼ Bolt ê¸°ëŠ¥ êµ¬í˜„</h3>
<ul>
  <li>ì—ìŠ¤í¼ BoltëŠ” ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ì ê°€ìš´ë° ê³¼ì†ì„ í•˜ëŠ” ìš´ì „ìë¥¼ ì°¾ì•„ ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ê¸°ëŠ¥</li>
  <li>ì—ìŠ¤í¼ Boltì˜ ì´ë²¤íŠ¸ êµ¬í˜„ì€ <strong>ì—ìŠ¤í¼ CEP ì—”ì§„</strong> ì´ìš©</li>
  <li>ì´ë•Œ EPL ì¿¼ë¦¬ë¡œ 30ì´ˆ Window-Time ê¸°ì¤€ìœ¼ë¡œ í‰ê·  ì†ë„ 80km/hë¥¼ ì´ˆê³¼í•œ ìš´ì „ìë¥¼ ì°¾ê¸° ìœ„í•œ ë£° ì‘ì„±
    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">EPL</code> : select, from, where, having ì ˆ ë“±ì„ ê°–ëŠ” ê¸°ì¡´ SQLê³¼ ìœ ì‚¬í•œ ì§ˆì˜ ì–¸ì–´</p>
    </blockquote>
  </li>
  <li>
    <p>í•´ë‹¹ ì°¨ëŸ‰ ë²ˆí˜¸ì™€ í‰ê·  ì†ë„ë¥¼ ì´ˆê³¼í•œ ì‹œì ì˜ ì‹œê°„ ì •ë³´ë¥¼ ë‹¤ìŒ Boltì— ì „ë‹¬</p>
  </li>
  <li>EsperBolt.java ì „ì²´ ì½”ë“œ
```java
package com.wikibook.bigdata.smartcar.storm;</li>
</ul>

<p>import java.util.Map;</p>

<p>import backtype.storm.task.TopologyContext;
import backtype.storm.topology.BasicOutputCollector;
import backtype.storm.topology.OutputFieldsDeclarer;
import backtype.storm.topology.base.BaseBasicBolt;
import backtype.storm.tuple.Fields;
import backtype.storm.tuple.Tuple;
import backtype.storm.tuple.Values;</p>

<p>import com.espertech.esper.client.Configuration;
import com.espertech.esper.client.EPServiceProvider;
import com.espertech.esper.client.EPServiceProviderManager;
import com.espertech.esper.client.EPStatement;
import com.espertech.esper.client.EventBean;
import com.espertech.esper.client.UpdateListener;</p>

<p>public class EsperBolt extends BaseBasicBolt{</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private static final long serialVersionUID = 1L;

private EPServiceProvider espService;

private boolean isOverSpeedEvent = false;

public void prepare(Map stormConf, TopologyContext context) {

	Configuration configuration = new Configuration();
	configuration.addEventType("DriverCarInfoBean", DriverCarInfoBean.class.getName());

	espService = EPServiceProviderManager.getDefaultProvider(configuration);
	espService.initialize();
	
	int avgOverSpeed = 80;
	int windowTime  = 30;
	
	String overSpeedEpl =  "SELECT date, carNumber, speedPedal, breakPedal, "
							+ "steerAngle, directLight, speed , areaNumber "
							+ " FROM DriverCarInfoBean.win:time_batch("+windowTime+" sec) "
							+ " GROUP BY carNumber HAVING AVG(speed) &gt; " + avgOverSpeed;

	EPStatement driverCarinfoStmt = espService.getEPAdministrator().createEPL(overSpeedEpl);

	driverCarinfoStmt.addListener((UpdateListener) new OverSpeedEventListener());
}



public void execute(Tuple tuple, BasicOutputCollector collector) {

	// TODO Auto-generated method stub
	String tValue = tuple.getString(0); 

	//ë°œìƒì¼ì‹œ(14ìë¦¬), ì°¨ëŸ‰ë²ˆí˜¸, ê°€ì†í˜ë‹¬, ë¸Œë ˆì´í¬í˜ë‹¬, ìš´ì „ëŒ€íšŒì ê°, ë°©í–¥ì§€ì‹œë“±, ì£¼í–‰ì†ë„, ë®¤ì§ë²ˆí˜¸
	String[] receiveData = tValue.split("\\,");

	DriverCarInfoBean driverCarInfoBean =new DriverCarInfoBean();

	driverCarInfoBean.setDate(receiveData[0]);
	driverCarInfoBean.setCarNumber(receiveData[1]);
	driverCarInfoBean.setSpeedPedal(receiveData[2]);
	driverCarInfoBean.setBreakPedal(receiveData[3]);
	driverCarInfoBean.setSteerAngle(receiveData[4]);
	driverCarInfoBean.setDirectLight(receiveData[5]);
	driverCarInfoBean.setSpeed(Integer.parseInt(receiveData[6]));
	driverCarInfoBean.setAreaNumber(receiveData[7]);

	espService.getEPRuntime().sendEvent(driverCarInfoBean); 


	if(isOverSpeedEvent) {
		//ë°œìƒì¼ì‹œ(14ìë¦¬), ì°¨ëŸ‰ë²ˆí˜¸
		collector.emit(new Values(	driverCarInfoBean.getDate().substring(0,8), 
									driverCarInfoBean.getCarNumber()+"-"+driverCarInfoBean.getDate()));
		isOverSpeedEvent = false;
	}

}

public void declareOutputFields(OutputFieldsDeclarer declarer) {
	// TODO Auto-generated method stub
	declarer.declare(new Fields("date", "car_number"));
}


private class OverSpeedEventListener implements UpdateListener
{
	@Override
	public void update(EventBean[] newEvents, EventBean[] oldEvents) {
		if (newEvents != null) {
			try {
				isOverSpeedEvent = true;
			} catch (Exception e) {
				System.out.println("Failed to Listener Update" + e);
			} 
		}
	}
}
</code></pre></div></div>

<p>}</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;br&gt;

- **ì—ìŠ¤í¼ Bolt ì†ŒìŠ¤1 - EsperBolt.javaì—ì„œ ì—ìŠ¤í¼ì˜ EPL ì¿¼ë¦¬ ì •ì˜ ë° ì´ë²¤íŠ¸ í•¨ìˆ˜ ë“±ë¡**
```java
package com.wikibook.bigdata.smartcar.storm;

import java.util.Map;

import backtype.storm.task.TopologyContext;
import backtype.storm.topology.BasicOutputCollector;
import backtype.storm.topology.OutputFieldsDeclarer;
import backtype.storm.topology.base.BaseBasicBolt;
import backtype.storm.tuple.Fields;
import backtype.storm.tuple.Tuple;
import backtype.storm.tuple.Values;

import com.espertech.esper.client.Configuration;
import com.espertech.esper.client.EPServiceProvider;
import com.espertech.esper.client.EPServiceProviderManager;
import com.espertech.esper.client.EPStatement;
import com.espertech.esper.client.EventBean;
import com.espertech.esper.client.UpdateListener;


public class EsperBolt extends BaseBasicBolt{

	private static final long serialVersionUID = 1L;

	private EPServiceProvider espService;

	private boolean isOverSpeedEvent = false;

	public void prepare(Map stormConf, TopologyContext context) {

		Configuration configuration = new Configuration();
		configuration.addEventType("DriverCarInfoBean", DriverCarInfoBean.class.getName());

		espService = EPServiceProviderManager.getDefaultProvider(configuration);
		espService.initialize();
		
        // â“µ
		int avgOverSpeed = 80;
		int windowTime  = 30;
		
		String overSpeedEpl =  "SELECT date, carNumber, speedPedal, breakPedal, "
								+ "steerAngle, directLight, speed , areaNumber "
								+ " FROM DriverCarInfoBean.win:time_batch("+windowTime+" sec) "
								+ " GROUP BY carNumber HAVING AVG(speed) &gt; " + avgOverSpeed;

		EPStatement driverCarinfoStmt = espService.getEPAdministrator().createEPL(overSpeedEpl);

        // â“¶
		driverCarinfoStmt.addListener((UpdateListener) new OverSpeedEventListener());
	}
</code></pre></div></div>

<ul>
  <li>â“µ
    <ul>
      <li>ì‹¤ì‹œê°„ìœ¼ë¡œ ìœ ì…ë˜ëŠ” ìŠ¤íŠ¸ë¦¼ ë°ì´í„°ë¥¼ ëŒ€ìƒìœ¼ë¡œ ë§¤ 30ì´ˆ ë™ì•ˆ í‰ê·  ì†ë„ 80km/hë¥¼ ì´ˆê³¼í•œ ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ìë¥¼ ê°ì§€í•˜ê¸° ìœ„í•œ ì—ìŠ¤í¼ EPL ì¿¼ë¦¬ ì •ì˜</li>
      <li>Fromì ˆì—ì„œ <strong>Window-Time</strong>ì´ë¼ëŠ” ê¸°ëŠ¥ì„ ì´ìš©í•´ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¼ ë°ì´í„°ë¥¼ <code class="language-plaintext highlighter-rouge">Group By</code>í•œ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ ìƒì— ì˜¬ë ¤ë†“ê³  30ì´ˆ ë‹¨ìœ„ë¡œ í‰ê·  ì†ë„ ê³„ì‚°</li>
    </ul>
  </li>
  <li>â“¶
    <ul>
      <li>â“µì—ì„œ ì •ì˜í•œ EPL ì¿¼ë¦¬ ì¡°ê±´ì— ì¼ì¹˜í•˜ëŠ” ë°ì´í„°ê°€ ë°œìƒí–ˆì„ ë•Œ í˜¸ì¶œë  ì´ë²¤íŠ¸ í•¨ìˆ˜ ì‘ì„±</li>
      <li>í•¨ìˆ˜ëª…: <code class="language-plaintext highlighter-rouge">OverSpeedEventListener()</code></li>
    </ul>
  </li>
</ul>

<p><br /></p>

<blockquote>
  <p><strong>ì—ìŠ¤í¼ EPL ë™ì  ë¡œë”©</strong></p>
  <ul>
    <li>ì•ì˜ ì†ŒìŠ¤ë¥¼ ë³´ë©´ ì—ìŠ¤í¼ì˜ ë£°ì¸ EPLì„ EsperBolt.javaì— ì§ì ‘ ì‘ì„±í–ˆìŒ</li>
    <li>í•˜ì§€ë§Œ, EPLì€ ì—…ë£¨ ë£°ì´ ë°”ë€” ë•Œë§ˆë‹¤ ë¹ˆë²ˆí•˜ê²Œ ìˆ˜ì •ë˜ë¯€ë¡œ í”„ë¡œê·¸ë¨ ì•ˆì— ì§ì ‘ í•˜ë“œì½”ë”©í•˜ëŠ” ê²ƒì€ ì¢‹ì€ ë°©ë²•ì´ ì•„ë‹˜</li>
    <li>ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” EPL ì¿¼ë¦¬ë¥¼ ë³„ë„ì˜ ê³µìœ  ì €ì¥ì†Œë¥¼ êµ¬ì¶•í•´ í†µí•© ë³´ê´€í•˜ê³ , ìŠ¤í†°ì˜ Boltê°™ì€ í”„ë¡œê·¸ë¨ì´ ì´ ì €ì¥ì†Œë¡œë¶€í„° EPL ì¿¼ë¦¬ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ë¡œë”©í•˜ê±°ë‚˜, ì—­ìœ¼ë¡œ ìŠ¤í†°ì˜ Boltë¡œ í‘¸ì‹œí•˜ëŠ” ì•„í‚¤í…ì²˜ êµ¬ì„±í•¨ <br />
<img src="img/CH05/e2.png" alt="" /></li>
    <li>ìœ„ ê·¸ë¦¼ì„ ë³´ë©´ EPLì˜ ê³µìœ  ì €ì¥ì†Œë¥¼ ì¹´í”„ì¹´ ë˜ëŠ” ë ˆë””ìŠ¤ë¡œ ë§Œë“¤ê³ , EPL ìˆ˜ì •ì´ ë°œìƒí•˜ë©´ ìŠ¤í†°ì˜ Boltê°€ ê³µìœ  ì €ì¥ì†Œë¡œë¶€í„° EPLì„ ìˆ˜ì‹ ë°›ì•„ ë™ì ìœ¼ë¡œ êµì²´í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ EPL ì¿¼ë¦¬ ê´€ë¦¬</li>
  </ul>
</blockquote>

<p><br /></p>

<ul>
  <li><strong>ì—ìŠ¤í¼ Bolt ì†ŒìŠ¤2 - EsperBolt.javaì˜ ì—ìŠ¤í¼ ì´ë²¤íŠ¸ í•¨ìˆ˜</strong>
```java
private class OverSpeedEventListener implements UpdateListener
  {
      @Override
      public void update(EventBean[] newEvents, EventBean[] oldEvents) {
          if (newEvents != null) {
              try {
                  isOverSpeedEvent = true;   // â“µ
              } catch (Exception e) {
                  System.out.println(â€œFailed to Listener Updateâ€ + e);
              } 
          }
      }
  }</li>
</ul>

<p>}</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- EPLë¡œ ì •ì˜í•œ ì´ë²¤íŠ¸ ì¡°ê±´ì´ ë°œìƒí•  ë•Œ í˜¸ì¶œë˜ëŠ” OverSpeedEventLister() í•¨ìˆ˜
- â“µ 
    - ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ì—ìŠ¤í¼ Boltì˜ ë©¤ë²„ ë³€ìˆ˜ì¸ `isOverSpeedEvent`ë¥¼ `true`ê°’ìœ¼ë¡œ ì„¤ì •í•´ì„œ í•´ë‹¹ ì¡°ê±´ì˜ ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆìŒì„ ì¸ì§€í•  ìˆ˜ ìˆê²Œ í•¨
- ì—ìŠ¤í¼ì˜ ê¸°ëŠ¥ì„ ì´ìš©í•´ ìš´ì „ìì˜ ì‹¤ì‹œê°„ ìš´í–‰ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ëª¨ë“  ì‘ì—… ë§ˆì¹¨

&lt;br&gt;

- Boltì˜ ê³ ìœ  ê¸°ëŠ¥ì¸ íŠœí”Œë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì•„ ì²˜ë¦¬í•˜ëŠ” í”„ë¡œê·¸ë¨ ì†ŒìŠ¤
- **ì—ìŠ¤í¼ Bolt ì†ŒìŠ¤3 - EsperBolt.javaì˜ EPL ì¿¼ë¦¬ ì •ì˜ ë° ì´ë²¤íŠ¸ í•¨ìˆ˜ ë“±ë¡
```java
public void execute(Tuple tuple, BasicOutputCollector collector) {

		// â“µ
		String tValue = tuple.getString(0); 

		//ë°œìƒì¼ì‹œ(14ìë¦¬), ì°¨ëŸ‰ë²ˆí˜¸, ê°€ì†í˜ë‹¬, ë¸Œë ˆì´í¬í˜ë‹¬, ìš´ì „ëŒ€íšŒì ê°, ë°©í–¥ì§€ì‹œë“±, ì£¼í–‰ì†ë„, ë®¤ì§ë²ˆí˜¸
		String[] receiveData = tValue.split("\\,");

        // â“¶
		DriverCarInfoBean driverCarInfoBean =new DriverCarInfoBean();

		driverCarInfoBean.setDate(receiveData[0]);
		driverCarInfoBean.setCarNumber(receiveData[1]);
		driverCarInfoBean.setSpeedPedal(receiveData[2]);
		driverCarInfoBean.setBreakPedal(receiveData[3]);
		driverCarInfoBean.setSteerAngle(receiveData[4]);
		driverCarInfoBean.setDirectLight(receiveData[5]);
		driverCarInfoBean.setSpeed(Integer.parseInt(receiveData[6]));
		driverCarInfoBean.setAreaNumber(receiveData[7]);

		espService.getEPRuntime().sendEvent(driverCarInfoBean); 

        // â“·
		if(isOverSpeedEvent) {
			//ë°œìƒì¼ì‹œ(14ìë¦¬), ì°¨ëŸ‰ë²ˆí˜¸
			collector.emit(new Values(	driverCarInfoBean.getDate().substring(0,8), 
										driverCarInfoBean.getCarNumber()+"-"+driverCarInfoBean.getDate()));
			isOverSpeedEvent = false;
		}

	}

	public void declareOutputFields(OutputFieldsDeclarer declarer) {
		// TODO Auto-generated method stub
		declarer.declare(new Fields("date", "car_number"));
	}
</code></pre></div></div>

<ul>
  <li>â“µ
    <ul>
      <li>SplitBoltì™€ ìœ ì‚¬í•œ ì½”ë“œë¡œ, íŠœí”Œë¡œë¶€í„° ë°›ì€ ë°ì´í„°ë¥¼ <code class="language-plaintext highlighter-rouge">,</code>ë¡œ ë¶„ë¦¬í•´ì„œ ë°°ì—´ì— ë‹´ìŒ</li>
    </ul>
  </li>
  <li>â“¶
    <ul>
      <li>ì—ìŠ¤í¼ì—ì„œ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ìë°” VO(Value Object) ì‚¬ìš©</li>
      <li>ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ìì˜ ìš´í–‰ ì •ë³´ë¥¼ ê°ì²´í™” í•œ <strong>DriverCarInfoBean</strong>ì´ë¼ëŠ” VOë¥¼ ìƒì„±í•˜ê³ , â“µì—ì„œ ë¶„ë¦¬í•œ ìš´í–‰ ì •ë³´ë¥¼ ì„¤ì •í•œ ë’¤ ì—ìŠ¤í¼ ì—”ì§„ì— ë“±ë¡</li>
    </ul>
  </li>
  <li>â“·
    <ul>
      <li>ê³¼ì† ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ í•´ë‹¹ ë°ì´í„°ë¥¼ ë‹¤ìŒ Boltë¡œ ì „ì†¡</li>
      <li>ì´ë•Œ ê³¼ì† <strong>ë°œìƒì¼ì</strong>ì™€ <strong>ê³¼ì† ì°¨ëŸ‰ë²ˆí˜¸ + íƒ€ì„ìŠ¤íƒ¬í”„</strong>ë¥¼ ë°ì´í„°ë¡œ ì „ì†¡</li>
      <li>ë’¤ì—ì„œ <strong>ë°œìƒì¼ì</strong>ëŠ” ë ˆë””ìŠ¤ì˜ í‚¤ë¡œ ì‚¬ìš©ë˜ê³ , <strong>ê³¼ì† ì°¨ëŸ‰ë²ˆí˜¸ + íƒ€ì„ìŠ¤íƒ¬í”„</strong>ëŠ” Set ë°ì´í„° íƒ€ì…ì˜ ê°’ìœ¼ë¡œ ì‚¬ìš©ë¨</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="5-ë ˆë””ìŠ¤-bolt-ê¸°ëŠ¥-êµ¬í˜„">5) ë ˆë””ìŠ¤ Bolt ê¸°ëŠ¥ êµ¬í˜„</h3>
<ul>
  <li>ë ˆë””ìŠ¤ BoltëŠ” ê³¼ì† ì°¨ëŸ‰ì˜ ë°ì´í„°ê°€ ë°œìƒí•œ ê²½ìš°ì—ë§Œ ì‘ë™</li>
  <li>ë ˆë””ìŠ¤ ì„œë²„ì— <strong>ê³¼ì† ì¼ì</strong>ë¥¼ keyë¡œ í•˜ê³ , ê³¼ì†í•œ ìš´ì „ìì˜ <strong>ì°¨ëŸ‰ ë²ˆí˜¸ + íƒ€ì„ìŠ¤íƒ¬í”„</strong> ë°ì´í„°ë¥¼ ê°’ìœ¼ë¡œ ì ì¬</li>
  <li>ë ˆë””ìŠ¤ Bolt êµ¬í˜„ì˜ í•µì‹¬ì€ ë ˆë””ìŠ¤ í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ <strong>ì œë””ìŠ¤(Jedis)</strong></li>
</ul>

<p><br /></p>

<ul>
  <li>JedisPoolConfigë¥¼ ì´ìš©í•œ RedisBolt ìƒì„±ê³¼ Topology ë“±ë¡ ë°©ë²•</li>
  <li><strong>ë ˆë””ìŠ¤ Bolt ìƒì„± - SmartCarDriverTopology.java</strong>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// â“µ</span>
  <span class="c1">// Redis Bolt</span>
  <span class="nc">String</span> <span class="n">redisServer</span> <span class="o">=</span> <span class="s">"server02.hadoop.com"</span><span class="o">;</span>
  <span class="kt">int</span> <span class="n">redisPort</span> <span class="o">=</span> <span class="mi">6379</span><span class="o">;</span>
  <span class="nc">JedisPoolConfig</span> <span class="n">jedisPoolConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JedisPoolConfig</span><span class="o">.</span><span class="na">Builder</span><span class="o">().</span><span class="na">setHost</span><span class="o">(</span><span class="n">redisServer</span><span class="o">).</span><span class="na">setPort</span><span class="o">(</span><span class="n">redisPort</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
  <span class="nc">RedisBolt</span> <span class="n">redisBolt</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RedisBolt</span><span class="o">(</span><span class="n">jedisPoolConfig</span><span class="o">);</span>
	
  <span class="c1">// â“¶</span>
  <span class="n">driverCarTopologyBuilder</span><span class="o">.</span><span class="na">setBolt</span><span class="o">(</span><span class="s">"REDIS"</span><span class="o">,</span> <span class="n">redisBolt</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="na">shuffleGrouping</span><span class="o">(</span><span class="s">"esperBolt"</span><span class="o">);</span>

  <span class="k">return</span> <span class="n">driverCarTopologyBuilder</span><span class="o">.</span><span class="na">createTopology</span><span class="o">();</span>
</code></pre></div>    </div>
  </li>
  <li>â“µ
    <ul>
      <li>ë ˆë””ìŠ¤ì˜ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì´ìš©í•˜ê¸° ìœ„í•´ JedisPoolConfig ì„¤ì •</li>
      <li>ë ˆë””ìŠ¤ ì„œë²„ ì£¼ì†Œì™€ í¬íŠ¸ ì •ë³´ë¥¼ Configë¡œ ì„¤ì •í•˜ê³ , í•´ë‹¹ Configë¥¼ ì´ìš©í•´ RedisBolt ê°ì²´ ìƒì„±</li>
    </ul>
  </li>
  <li>â“¶
    <ul>
      <li>ìƒì„±í•œ RedisBolt ê°ì²´ë¥¼ ìŠ¤í†°ì˜ Topologyì— ë“±ë¡</li>
      <li>â€˜ê³ ìœ  IDâ€™, â€˜RedisBolt ê°ì²´â€™, â€˜ë³‘ë ¬ ì²˜ë¦¬ íŒíŠ¸â€™ ì„¤ì •</li>
      <li>EsperBoltë¡œë¶€í„° ë°ì´í„°ë¥¼ ì „ë‹¬ë°›ê¸° ìœ„í•´ ê·¸ë£¨í•‘ëª…ì„ EsperBolt IDì¸ <code class="language-plaintext highlighter-rouge">esperBolt</code>ë¡œ ì„¤ì •</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>AbstractJedisBolt í´ë˜ìŠ¤ë¥¼ ìƒì†í•˜ê³ , ì œë””ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•˜ê³  ìˆëŠ” RedisBolt ì†ŒìŠ¤</li>
  <li><strong>ë ˆë””ìŠ¤ Bolt ì†ŒìŠ¤ - RedisBolt.java</strong></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.wikibook.bigdata.smartcar.storm</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.storm.redis.bolt.AbstractRedisBolt</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.storm.redis.common.config.JedisClusterConfig</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.storm.redis.common.config.JedisPoolConfig</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">redis.clients.jedis.JedisCommands</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">redis.clients.jedis.exceptions.JedisConnectionException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">redis.clients.jedis.exceptions.JedisException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">backtype.storm.topology.OutputFieldsDeclarer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">backtype.storm.tuple.Tuple</span><span class="o">;</span>

<span class="kd">public</span>  <span class="kd">class</span> <span class="nc">RedisBolt</span> <span class="kd">extends</span> <span class="nc">AbstractRedisBolt</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

	<span class="kd">public</span> <span class="nf">RedisBolt</span><span class="o">(</span><span class="nc">JedisPoolConfig</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>
		<span class="kd">super</span><span class="o">(</span><span class="n">config</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="nf">RedisBolt</span><span class="o">(</span><span class="nc">JedisClusterConfig</span>  <span class="n">config</span><span class="o">)</span> <span class="o">{</span>
		<span class="kd">super</span><span class="o">(</span><span class="n">config</span><span class="o">);</span>
	<span class="o">}</span>


	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">(</span><span class="nc">Tuple</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// â“µ</span>
		<span class="nc">String</span> <span class="n">date</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">getStringByField</span><span class="o">(</span><span class="s">"date"</span><span class="o">);</span>
		<span class="nc">String</span> <span class="n">car_number</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">getStringByField</span><span class="o">(</span><span class="s">"car_number"</span><span class="o">);</span>

        <span class="c1">// â“¶</span>
		<span class="nc">JedisCommands</span> <span class="n">jedisCommands</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

		<span class="k">try</span> <span class="o">{</span>
            
			<span class="n">jedisCommands</span> <span class="o">=</span> <span class="n">getInstance</span><span class="o">();</span>
			<span class="n">jedisCommands</span><span class="o">.</span><span class="na">sadd</span><span class="o">(</span><span class="n">date</span><span class="o">,</span> <span class="n">car_number</span><span class="o">);</span>
			
			<span class="n">jedisCommands</span><span class="o">.</span><span class="na">expire</span><span class="o">(</span><span class="n">date</span><span class="o">,</span> <span class="mi">604800</span><span class="o">);</span>
        

		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">JedisConnectionException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Exception occurred to JedisConnection"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">JedisException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Exception occurred from Jedis/Redis"</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>

			<span class="k">if</span> <span class="o">(</span><span class="n">jedisCommands</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">returnInstance</span><span class="o">(</span><span class="n">jedisCommands</span><span class="o">);</span>
			<span class="o">}</span>
			<span class="k">this</span><span class="o">.</span><span class="na">collector</span><span class="o">.</span><span class="na">ack</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">declareOutputFields</span><span class="o">(</span><span class="nc">OutputFieldsDeclarer</span> <span class="n">declarer</span><span class="o">)</span> <span class="o">{</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>â“µ
    <ul>
      <li>íŠœí”Œ íƒ€ì…ì¸ <code class="language-plaintext highlighter-rouge">input</code> ê°ì²´ì—ëŠ” ì—ìŠ¤í¼ Boltì—ì„œ ì „ì†¡í•œ ê³¼ì† ìš´ì „ìì˜ <strong>ê³¼ì†ë‚ ì§œ</strong>ì™€ <strong>ì°¨ëŸ‰ë²ˆí˜¸</strong> ë°ì´í„°ê°€ ìˆìŒ</li>
      <li>ì´ ë°ì´í„°ë¥¼ String íƒ€ì…ì˜ <strong>date</strong>, <strong>car_number</strong> ë³€ìˆ˜ì— ê°ê° í• ë‹¹</li>
    </ul>
  </li>
  <li>â“¶
    <ul>
      <li>ë ˆë””ìŠ¤ í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ <strong>JedisCommands</strong> ì´ìš©</li>
      <li>â“µì—ì„œ ìƒì„±í•œ <strong>ê³¼ì†ë‚ ì§œ(date)</strong>ë¥¼ keyë¡œ í•˜ê³ , <strong>ì°¨ëŸ‰ë²ˆí˜¸(car_number)</strong>ë¥¼ set íƒ€ì…ì˜ ê°’ìœ¼ë¡œ í•´ì„œ ë ˆë””ìŠ¤ ì„œë²„ì— ì ì¬</li>
      <li>ì¶”ê°€ë¡œ ì ì¬ ë°ì´í„°ì— ëŒ€í•œ ë§Œë£Œ ì‹œê°„ì„ 604800ì´ˆ(ì¼ì£¼ì¼)ë¡œ ì„¤ì •í•´ì„œ, ì ì¬ í›„ ì¼ì£¼ì¼ì´ ê²½ê³¼í•˜ë©´ í•´ë‹¹ ê³¼ì† ìš´í–‰ ë°ì´í„°ëŠ” ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë˜ê²Œ í•¨</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="6-ë ˆë””ìŠ¤-í´ë¼ì´ì–¸íŠ¸-ì• í”Œë¦¬ì¼€ì´ì…˜-êµ¬í˜„">6) ë ˆë””ìŠ¤ í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬í˜„</h3>
<p><img src="img/CH05/rca.png" alt="" /></p>
<ul>
  <li>ì•ì„œ ë ˆë””ìŠ¤ Boltì—ì„œ ë ˆë””ìŠ¤ ì„œë²„ì— ì ì¬í•œ ê³¼ì† ì°¨ëŸ‰ ì •ë³´ëŠ” ìŠ¤í”¼ë“œ ë°ì´í„°ë¡œë¶€í„° ì¶”ì¶œëœ ìœ ìš©í•œ ì •ë³´</li>
  <li>ì´ì²˜ëŸ¼ ê°€ì¹˜ìˆëŠ” ì‹¤ì‹œê°„ ì •ë³´ëŠ” ì£¼ë³€ ì—…ë¬´ ì‹œìŠ¤í…œì—ì„œ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•¨</li>
</ul>

<p><br /></p>

<ul>
  <li>ë ˆë””ìŠ¤ í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ ì œë””ìŠ¤ë¥¼ ì´ìš©í•´ ì‹¤ì‹œê°„ ê³¼ì† ì°¨ëŸ‰ ì •ë³´ë¥¼ ì—…ë¬´ ì‹œìŠ¤í…œ ì…ì¥ì—ì„œ í™œìš©í•˜ëŠ” ì˜ˆì œ</li>
  <li><strong>ë ˆë””ìŠ¤ í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ - RedisClient.java</strong></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.wikibook.bigdata.smartcar.redis</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Set</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">redis.clients.jedis.Jedis</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">redis.clients.jedis.JedisPool</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">redis.clients.jedis.JedisPoolConfig</span><span class="o">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RedisClient</span> <span class="kd">extends</span> <span class="nc">Thread</span><span class="o">{</span>

	<span class="kd">private</span> <span class="nc">String</span> <span class="n">key</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">Jedis</span> <span class="n">jedis</span><span class="o">;</span>

	<span class="kd">public</span> <span class="nf">RedisClient</span><span class="o">(</span><span class="nc">String</span> <span class="n">k</span><span class="o">)</span> <span class="o">{</span>

		<span class="nc">JedisPoolConfig</span> <span class="n">jedisPoolConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JedisPoolConfig</span><span class="o">();</span>
		<span class="nc">JedisPool</span> <span class="n">jPool</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JedisPool</span><span class="o">(</span><span class="n">jedisPoolConfig</span><span class="o">,</span> <span class="s">"server02.hadoop.com"</span><span class="o">,</span> <span class="mi">6379</span><span class="o">);</span>
		<span class="n">jedis</span> <span class="o">=</span> <span class="n">jPool</span><span class="o">.</span><span class="na">getResource</span><span class="o">();</span>

		<span class="k">this</span><span class="o">.</span><span class="na">key</span> <span class="o">=</span> <span class="n">k</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>    
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
		
		<span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">overSpeedCarList</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		
		<span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

		<span class="k">try</span> <span class="o">{</span>
			<span class="k">while</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>

				<span class="n">overSpeedCarList</span> <span class="o">=</span> <span class="n">jedis</span><span class="o">.</span><span class="na">smembers</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>

				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"################################################"</span><span class="o">);</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"#####   Start of The OverSpeed SmartCar    #####"</span><span class="o">);</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"################################################"</span><span class="o">);</span>
				
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\n[ Try No."</span> <span class="o">+</span> <span class="n">cnt</span><span class="o">++</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">);</span>

                <span class="c1">// â“µ</span>
				<span class="k">if</span><span class="o">(</span><span class="n">overSpeedCarList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
					<span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">list</span> <span class="o">:</span> <span class="n">overSpeedCarList</span><span class="o">)</span> <span class="o">{</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
					<span class="o">}</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
					
					<span class="n">jedis</span><span class="o">.</span><span class="na">del</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
                    
				<span class="o">}</span><span class="k">else</span><span class="o">{</span>

                    <span class="c1">// â“¶</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\nEmpty Car List...\n"</span><span class="o">);</span>
				<span class="o">}</span>

				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"################################################"</span><span class="o">);</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"######   End of The OverSpeed SmartCar    ######"</span><span class="o">);</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"################################################"</span><span class="o">);</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\n\n"</span><span class="o">);</span>

				<span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">10</span> <span class="o">*</span> <span class="mi">1000</span><span class="o">);</span>
			<span class="o">}</span>

		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="k">if</span><span class="o">(</span> <span class="n">jedis</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="n">jedis</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>â“µ
    <ul>
      <li>ë ˆë””ìŠ¤ì—ëŠ” ë‚ ì§œë¥¼ keyë¡œ í•´ì„œ ê³¼ì† ì°¨ëŸ‰ì˜ ë°ì´í„°ì…‹ì´ ì €ì¥ë˜ì–´ ìˆìŒ</li>
      <li>key(ë‚ ì§œ)ì— í•´ë‹¹í•˜ëŠ” ê³¼ì† ì°¨ëŸ‰ ì •ë³´ê°€ ë°œìƒí•˜ë©´ ì¦‰ì‹œ ê°€ì ¸ì™€ì„œ ì¶œë ¥</li>
    </ul>
  </li>
  <li>â“¶
    <ul>
      <li>ë ˆë””ìŠ¤ì—ì„œ ê°€ì ¸ì˜¨ keyì˜ ë°ì´í„° ì‚­ì œ</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="3-hbase-í…Œì´ë¸”-ìƒì„±">3. HBase í…Œì´ë¸” ìƒì„±</h2>
<ul>
  <li>íŒŒì¼ëŸ¿ í”Œì ì—ì„œ ìˆ˜ì§‘í•œ ìš´ì „ìì˜ ëª¨ë“  ìš´í–‰ ì •ë³´ëŠ” HBaseì— ì ì¬ë¨</li>
  <li>ì•„ë˜ ì½”ë“œëŠ” ìŠ¤í†°ì˜ HBase-Bolt ê´€ë ¨ ì†ŒìŠ¤ì½”ë“œë¥¼ ì¼ë¶€ ë°œì·Œí•œ ê²ƒìœ¼ë¡œ, ìˆ˜ì‹ ë°›ì€ íŠœí”Œ ë°ì´í„°(ìš´ì „ì ë°ì´í„°)ë¥¼ HBaseì— ëª¨ë‘ ì ì¬</li>
</ul>

<p><br /></p>

<ul>
  <li><strong>HBaseì˜ HTable êµ¬ì„± ì •ë³´ - SmartCarDriverTopology.java</strong>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// HBase Bolt</span>
  <span class="nc">TupleTableConfig</span> <span class="n">hTableConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TupleTableConfig</span><span class="o">(</span><span class="s">"DriverCarInfo"</span><span class="o">,</span> <span class="s">"r_key"</span><span class="o">);</span>  <span class="c1">// â“µ</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">setZkQuorum</span><span class="o">(</span><span class="s">"server02.hadoop.com"</span><span class="o">);</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">setZkClientPort</span><span class="o">(</span><span class="s">"2181"</span><span class="o">);</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">setBatch</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
                       <span class="c1">// â“¶      â“·</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">addColumn</span><span class="o">(</span><span class="s">"cf1"</span><span class="o">,</span> <span class="s">"date"</span><span class="o">);</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">addColumn</span><span class="o">(</span><span class="s">"cf1"</span><span class="o">,</span> <span class="s">"car_number"</span><span class="o">);</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">addColumn</span><span class="o">(</span><span class="s">"cf1"</span><span class="o">,</span> <span class="s">"speed_pedal"</span><span class="o">);</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">addColumn</span><span class="o">(</span><span class="s">"cf1"</span><span class="o">,</span> <span class="s">"break_pedal"</span><span class="o">);</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">addColumn</span><span class="o">(</span><span class="s">"cf1"</span><span class="o">,</span> <span class="s">"steer_angle"</span><span class="o">);</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">addColumn</span><span class="o">(</span><span class="s">"cf1"</span><span class="o">,</span> <span class="s">"direct_light"</span><span class="o">);</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">addColumn</span><span class="o">(</span><span class="s">"cf1"</span><span class="o">,</span> <span class="s">"speed"</span><span class="o">);</span>
  <span class="n">hTableConfig</span><span class="o">.</span><span class="na">addColumn</span><span class="o">(</span><span class="s">"cf1"</span><span class="o">,</span> <span class="s">"area_number"</span><span class="o">);</span>
		
  <span class="nc">HBaseBolt</span> <span class="n">hbaseBolt</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HBaseBolt</span><span class="o">(</span><span class="n">hTableConfig</span><span class="o">);</span>
  <span class="n">driverCarTopologyBuilder</span><span class="o">.</span><span class="na">setBolt</span><span class="o">(</span><span class="s">"HBASE"</span><span class="o">,</span> <span class="n">hbaseBolt</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="na">shuffleGrouping</span><span class="o">(</span><span class="s">"splitBolt"</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>â“µ
    <ul>
      <li>ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ì ì¬í•  HBase í…Œì´ë¸”ëª… <code class="language-plaintext highlighter-rouge">DriverCarInfo</code>ì™€ ë¡œìš°í‚¤ëª… <code class="language-plaintext highlighter-rouge">r_key</code> ì„¤ì •</li>
    </ul>
  </li>
  <li>â“¶
    <ul>
      <li><code class="language-plaintext highlighter-rouge">DriverCarInfo</code> í…Œì´ë¸”ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì¹¼ëŸ¼ íŒ¨ë°€ë¦¬ëª… <code class="language-plaintext highlighter-rouge">cf1</code> ì„¤ì •</li>
    </ul>
  </li>
  <li>â“·
    <ul>
      <li>ì¹¼ëŸ¼ íŒ¨ë°€ë¦¬ëª… <code class="language-plaintext highlighter-rouge">cf1</code>ì—ì„œ ì‚¬ìš©í•  í•„ë“œëª… ì„¤ì •</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>ìœ„ì˜ ì½”ë“œê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ë ¤ë©´ ì„¤ì •í•œ HBase í…Œì´ë¸”(DriverCarInfo), ë¡œìš°í‚¤(r_key), ì¹¼ëŸ¼íŒ¨ë°€ë¦¬(cf1)ê°€ HBase ì„œë²„ ìƒì— ìƒì„±ë˜ì–´ ìˆì–´ì•¼ í•¨</li>
  <li>Sever02ì— ì ‘ì†í•´ ì•„ë˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ê³ , <code class="language-plaintext highlighter-rouge">CREATE, Table Name: default: DriverCarInfo..</code> ë©”ì‹œì§€ ì¶œë ¥ë˜ëŠ”ì§€ í™•ì¸
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hbase org.apache.hadoop.hbase.util.RegionSplitter DriverCarInfo HexStringSplit <span class="nt">-c</span> 4 <span class="nt">-f</span> cf1
</code></pre></div>    </div>
  </li>
  <li>í•´ë‹¹ ëª…ë ¹ì€ HBaseì— DriverCarInfo í…Œì´ë¸” ìƒì„±</li>
  <li>RegionSplitterë¥¼ ì´ìš©í–ˆê³ , ì¹¼ëŸ¼íŒ¨ë°€ë¦¬ë¡œ <code class="language-plaintext highlighter-rouge">cf1</code>ì„ ì‚¬ìš©í•˜ëŠ” 24ê°œì˜ Regionì„ ë¯¸ë¦¬ ìƒì„±í•˜ê¸° ìœ„í•œ ì˜µì…˜ ì§€ì •í•¨</li>
  <li>ì´ë•Œ 4ê°œì˜ Regionì— ì ‘ê·¼í•˜ëŠ” ë°©ì‹ì€ ë¡œìš°í‚¤ì˜ HexString ê°’ì„ ì´ìš©í•˜ë„ë¡</li>
  <li>ì´ì²˜ëŸ¼ í…Œì´ë¸”ì˜ Regionì„ ë¯¸ë¦¬ ë¶„ë¦¬í•´ë†“ëŠ” ì´ìœ : ì´ˆê¸° ëŒ€ëŸ‰ ë°ì´í„° ë°œìƒì„ ê³ ë ¤í•´ ì—¬ëŸ¬ ê°œì˜ Regionì„ ë¯¸ë¦¬ ë§Œë“¤ì–´ ì„±ëŠ¥ê³¼ ì•ˆì •ì„±ì„ í™•ë³´í•  ìˆ˜ ìˆê¸° ë•Œë¬¸</li>
  <li>ë˜í•œ, Regionì´ íŠ¹ì • í¬ê¸°ì— ë„ë‹¬í•˜ë©´ ìë™ìœ¼ë¡œ ë¶„ë¦¬(ìƒ¤ë”©)ë˜ëŠ”ë°, ì´ëŸ¬í•œ ë¶„ë¦¬ ê³¼ì •ì—ì„œ ì„œë¹„ìŠ¤ê°€ ì¼ì‹œì ìœ¼ë¡œ ì¤‘ë‹¨ë˜ëŠ” í˜„ìƒë„ ë¯¸ì—°ì— ë°©ì§€í•  ìˆ˜ ìˆìŒ
<img src="img/CH05/hbase%20%ED%85%8C%EC%9D%B4%EB%B8%94%20%EC%83%9D%EC%84%B1.png" alt="" /></li>
</ul>

<p><br /></p>

<h2 id="4-ìŠ¤í†°-topology-ë°°í¬">4. ìŠ¤í†° Topology ë°°í¬</h2>
<p><img src="img/CH05/%EC%8B%A4%EC%8B%9C%EA%B0%84%EC%A0%81%EC%9E%AC%EA%B8%B0%EB%8A%A5.png" alt="" /></p>
<ul>
  <li>ìŠ¤í†° TopologyëŠ” ìœ„ ê·¸ë¦¼ì— ë‚˜ì™€ìˆëŠ” Spout, Boltì˜ êµ¬ì„±ê³¼ ë™ì‘ ë°©ì‹ ë“±ì„ ì •ì˜í•œ í•˜ë‚˜ì˜ ìë°” í”„ë¡œê·¸ë¨</li>
</ul>

<p><br /></p>

<ul>
  <li>ìŠ¤í†° Topology ì‘ì„±ì´ ì™„ë£Œë˜ë©´ <strong>Nimbus</strong>ë¥¼ í†µí•´ í•´ë‹¹ Topologyê°€ <strong>Supervisor</strong>ì— ë°°í¬ë˜ê³ , Supervisorì˜ <strong>worker</strong> ìœ„ì— ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ìŠ¤í†°ì˜ ëŸ°íƒ€ì„ í™˜ê²½ì´ ìƒì„±ë¨</li>
</ul>

<p><br /></p>

<h3 id="ìš´ì „ìì˜-ì‹¤ì‹œê°„-ìš´í–‰-ì •ë³´-ì²˜ë¦¬í•˜ëŠ”-ìŠ¤í†°-topology-ë°°í¬"><strong>ìš´ì „ìì˜ ì‹¤ì‹œê°„ ìš´í–‰ ì •ë³´ ì²˜ë¦¬í•˜ëŠ” ìŠ¤í†° Topology ë°°í¬</strong></h3>
<h4 id="1-ìŠ¤í†°ì—ì„œ-ì‚¬ìš©í•˜ëŠ”-ìë°”-í”„ë¡œê·¸ë¨-ì†ŒìŠ¤ë¥¼-ë¯¸ë¦¬-ì»´íŒŒì¼í•´ì„œ-íŒ¨í‚¤ì§•í•œ-íŒŒì¼---server02ì—-ì—…ë¡œë“œ">1) ìŠ¤í†°ì—ì„œ ì‚¬ìš©í•˜ëŠ” ìë°” í”„ë¡œê·¸ë¨ ì†ŒìŠ¤ë¥¼ ë¯¸ë¦¬ ì»´íŒŒì¼í•´ì„œ íŒ¨í‚¤ì§•í•œ íŒŒì¼ -&gt; Server02ì— ì—…ë¡œë“œ</h4>
<ul>
  <li>íŒŒì¼ì§ˆë¼ ì‚¬ìš©</li>
</ul>

<p><br /></p>

<h4 id="2-ì—…ë¡œë“œí•œ-íŒŒì¼ì—-í¬í•¨ëœ-ìŠ¤í†°ì˜-topology-íŒŒì¼ì„-storm-ëª…ë ¹ì„-í†µí•´-drivercarinfoë¼ëŠ”-ì´ë¦„ìœ¼ë¡œ-ë°°í¬">2) ì—…ë¡œë“œí•œ íŒŒì¼ì— í¬í•¨ëœ ìŠ¤í†°ì˜ Topology íŒŒì¼ì„ storm ëª…ë ¹ì„ í†µí•´ <strong>DriverCarInfo</strong>ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë°°í¬</h4>
<ul>
  <li>ë°°í¬í•˜ê¸° ì „ ìŠ¤í†° Nimbus, Supervisor, Ui ì„œë²„ê°€ ì •ìƒ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/pilot-pjt/working   
storm jar bigdata.smartcar.storm-1.0.jar com.wikibook.bigdata.smartcar.storm.SmartCarDriverTopology DriverCarInfo
</code></pre></div>    </div>
  </li>
  <li>ë§ˆì§€ë§‰ì— <code class="language-plaintext highlighter-rouge">o.a.s.StormSubmitter - Finishd submitting topology: DriverCarInfo</code> ë©”ì‹œì§€ ì¶œë ¥ë˜ëŠ”ì§€ í™•ì¸
<img src="img/CH05/%EC%8A%A4%ED%86%B0%20topology%20%ED%8C%8C%EC%9D%BC%20%EB%B0%B0%ED%8F%AC1.png" alt="" />
<img src="img/CH05/%EC%8A%A4%ED%86%B0%20topology%20%ED%8C%8C%EC%9D%BC%20%EB%B0%B0%ED%8F%AC2.png" alt="" /></li>
</ul>

<p><br /></p>

<h4 id="3-ìŠ¤í†°-ê´€ë¦¬ì-uië¡œ-topologyê°€-ì •ìƒì ìœ¼ë¡œ-ë°°í¬ë˜ì—ˆëŠ”ì§€-í™•ì¸">3) ìŠ¤í†° ê´€ë¦¬ì UIë¡œ Topologyê°€ ì •ìƒì ìœ¼ë¡œ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸</h4>
<ul>
  <li>
    <p>Topology summaryì˜ DriverCarInfoë¼ëŠ” Topologyê°€ í™œì„±í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸ <br />
http://server02.hadoop.com:8088
<img src="img/CH05/%EC%8A%A4%ED%86%B0%20topology%20%EB%B0%B0%ED%8F%AC%20%ED%99%95%EC%9D%B8.png" alt="" /></p>
  </li>
  <li>[DriverCarInto Topology]ë¥¼ ë“¤ì–´ê°€ë©´ Topologyë¿ ì•„ë‹ˆë¼, ì¹´í”„ì¹´-Spout, ì—ìŠ¤í¼-Bolt, ë ˆë””ìŠ¤-Bolt ë“±ì˜ ìƒíƒœ ëª¨ë‹ˆí„°ë§ ê°€ëŠ¥</li>
  <li>[Show Visualization] í´ë¦­í•˜ë©´ ë°°í¬í•œ Topologyì˜ êµ¬ì¡°ë¶€í„° ë°ì´í„° ì²˜ë¦¬ëŸ‰ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§ ê°€ëŠ¥</li>
</ul>

<p><br /></p>

<h4 id="4-ìŠ¤í†°-topology-ì œê±°í•´ì•¼-í• -ê²½ìš°-ë‹¤ìŒ-kill-ëª…ë ¹-ì´ìš©">4) ìŠ¤í†° Topology ì œê±°í•´ì•¼ í•  ê²½ìš° ë‹¤ìŒ <code class="language-plaintext highlighter-rouge">kill</code> ëª…ë ¹ ì´ìš©</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>storm <span class="nb">kill</span> <span class="s2">"Topology ì´ë¦„"</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="5-ì‹¤ì‹œê°„-ì ì¬-ê¸°ëŠ¥-í…ŒìŠ¤íŠ¸">5. ì‹¤ì‹œê°„ ì ì¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h2>
<ul>
  <li>ì‹¤ì‹œê°„ ì ì¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ìì˜ ì‹¤ì‹œê°„ ìš´í–‰ì •ë³´ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ë¡œê·¸ ì‹œë®¬ë ˆì´í„° ì‘ë™</li>
  <li>í•´ë‹¹ ë¡œê·¸ íŒŒì¼ì„ í”ŒëŸ¼ì´ ìˆ˜ì§‘í•´ì„œ ì¹´í”„ì¹´ì— ì „ì†¡í•˜ê³ , ìŠ¤í†°ì´ ë‹¤ì‹œ ìˆ˜ì‹ ë°›ì•„ ëª¨ë“  ìš´í–‰ ë°ì´í„°ë¥¼ HBaseì— ì ì¬</li>
  <li>ê·¸ ì¤‘ ì—ìŠ¤í¼ì˜ ì†ë„ ìœ„ë°˜ ë£°ì— ê°ì§€ëœ ì°¨ëŸ‰ì€ ë ˆë””ìŠ¤ë¡œ ì ì¬</li>
</ul>

<p><br /></p>

<h3 id="1-ë¡œê·¸-ì‹œë®¬ë ˆì´í„°-ì‘ë™">1) ë¡œê·¸ ì‹œë®¬ë ˆì´í„° ì‘ë™</h3>
<ul>
  <li>ë¡œê·¸ ì‹œë®¬ë ˆì´í„°ê°€ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” Server02ì— ì ‘ì†í•´ì„œ <strong>DriverLogMain</strong>ì‘ë™</li>
  <li>2016ë…„ 1ì›” 3ì¼ 10ëŒ€ì˜ ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ì ì •ë³´ë§Œ ìƒì„±í•´ í…ŒìŠ¤íŠ¸</li>
  <li>ë¡œê·¸ê°€ ìƒì„±ë¨ê³¼ ë™ì‹œì— í”ŒëŸ¼ì˜ ìˆ˜ì§‘ ì´ë²¤íŠ¸ê°€ ì‘ë™í•˜ë©´ <strong>í”ŒëŸ¼ -&gt; ì¹´í”„ì¹´ -&gt; ìŠ¤í†° -&gt; HBase</strong> ìˆœìœ¼ë¡œ ë°ì´í„° ìˆ˜ì§‘ ë° ì ì¬ë¨
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/pilot-pjt/working
java <span class="nt">-cp</span> bigdata.smartcar.loggen-1.0.jar com.wikibook.bigdata.smartcar.loggen.DriverLogMain 20160103 10 &amp;
</code></pre></div>    </div>
    <p><img src="img/CH05/driverlogmain%20%EC%9E%91%EB%8F%99.png" alt="" /></p>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>ìš´ì „ìì˜ ì‹¤ì‹œê°„ ë¡œê·¸ê°€ ì •ìƒì ìœ¼ë¡œ ë°œìƒí•˜ëŠ”ì§€ í™•ì¸
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/pilot-pjt/working/driver-realtime-log
<span class="nb">tail</span> <span class="nt">-f</span> SmartCarDriverInfo.log
</code></pre></div>    </div>
    <p><img src="img/CH05/%EC%9A%B4%EC%A0%84%EC%9E%90%20%EC%8B%A4%EC%8B%9C%EA%B0%84%20%EB%A1%9C%EA%B7%B8%20%EB%B0%9C%EC%83%9D.png" alt="" /></p>
  </li>
</ul>

<p><br /></p>

<h3 id="2-hbase-ì ì¬-ë°ì´í„°-í™•ì¸">2) HBase ì ì¬ ë°ì´í„° í™•ì¸</h3>
<h4 id="1-hbase-ì‰˜ì˜-countëª…ë ¹ìœ¼ë¡œ-ì‹¤ì‹œê°„ìœ¼ë¡œ-ì ì¬ë˜ê³ -ìˆëŠ”-ìš´ì „ì-ì •ë³´-í™•ì¸">1) HBase ì‰˜ì˜ <code class="language-plaintext highlighter-rouge">count</code>ëª…ë ¹ìœ¼ë¡œ ì‹¤ì‹œê°„ìœ¼ë¡œ ì ì¬ë˜ê³  ìˆëŠ” ìš´ì „ì ì •ë³´ í™•ì¸</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hbase shell
hbase<span class="o">(</span>main<span class="o">)</span>:001:0&gt; count <span class="s1">'DriverCarInfo'</span>
</code></pre></div></div>
<ul>
  <li>DriverCarInfo í…Œì´ë¸”ì— ì ì¬ëœ ë°ì´í„°ì˜ ë¡œìš° ìˆ˜ë¥¼ 1000 ë‹¨ìœ„ë¡œ ì¶œë ¥
<img src="img/CH05/%EC%8B%A4%EC%8B%9C%EA%B0%84%20%EC%A0%81%EC%9E%AC%20%EC%9A%B4%EC%A0%84%EC%9E%90%20%EC%A0%95%EB%B3%B4%20%ED%99%95%EC%9D%B8.png" alt="" /></li>
  <li><code class="language-plaintext highlighter-rouge">count</code> ëª…ë ¹ì— ë”°ë¥¸ row ê°’ì„ ë³´ë©´ <strong>Split Bolt</strong>ì—ì„œ êµ¬í˜„í•œ ëŒ€ë¡œ ë¡œìš°í‚¤ ê°’ì´ <strong>íƒ€ì„ìŠ¤íƒ¬í”„-ë¦¬ë²„ìŠ¤ê°’ + ì°¨ëŸ‰ë²ˆí˜¸</strong> í˜•ì‹ìœ¼ë¡œ ì ì¬ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ</li>
</ul>

<p><br /></p>

<h4 id="2-scan-ëª…ë ¹ìœ¼ë¡œ-drivercarinfo-í…Œì´ë¸”ì—-ì ì¬ëœ-ì¹¼ëŸ¼-ê¸°ë°˜-êµ¬ì¡°ì˜-ë°ì´í„°-ì‚´í´ë³´ê¸°">2) <code class="language-plaintext highlighter-rouge">scan</code> ëª…ë ¹ìœ¼ë¡œ DriverCarInfo í…Œì´ë¸”ì— ì ì¬ëœ ì¹¼ëŸ¼ ê¸°ë°˜ êµ¬ì¡°ì˜ ë°ì´í„° ì‚´í´ë³´ê¸°</h4>
<ul>
  <li>ê·¸ëƒ¥ scan ëª…ë ¹ì„ ë‚´ë¦¬ë©´ ëª¨ë“  ë°ì´í„°ê°€ ì¡°íšŒë˜ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">LIMIT</code> ì˜µì…˜ìœ¼ë¡œ 20ê°œë§Œ ì¡°íšŒ
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hbase<span class="o">(</span>main<span class="o">)</span>:001:0&gt; scan <span class="s1">'DriverCarInfo;, {LIMIT=&gt;20}
</span></code></pre></div>    </div>
    <p><img src="img/CH05/%EC%BB%AC%EB%9F%BC%20%EA%B8%B0%EB%B0%98%20%EB%8D%B0%EC%9D%B4%ED%84%B0%2020%EA%B0%9C%EB%A7%8C.png" alt="" /></p>
  </li>
  <li>HBaseì˜ ì¹¼ëŸ¼ ê¸°ë°˜ í…Œì´ë¸” êµ¬ì¡°ë¡œ ë˜ì–´ìˆìŒ</li>
</ul>

<p><br /></p>

<ul>
  <li>í‘œë¡œ í‘œí˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ìŒ
<img src="img/CH05/hbase%20%ED%91%9C.png" alt="" /></li>
  <li>ë¡œìš°í‚¤ì™€ ì¹¼ëŸ¼íŒ¨ë°€ë¦¬(cf1)ì„ ê¸°ì¤€ìœ¼ë¡œ <strong>RowKey -&gt; Column -&gt; Family -&gt; Field -&gt; Version -&gt; Value</strong> ìˆœìœ¼ë¡œ ë°ì´í„° ë´„</li>
  <li><code class="language-plaintext highlighter-rouge">Version</code>ì€ í‘œì—ëŠ” ì—†ì§€ë§Œ, Filedì˜ Value ë°ì´í„°ê°€ ë°”ë€” ë•Œë§ˆë‹¤ íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ í†µí•´ ë²„ì „ ê´€ë¦¬</li>
  <li>ì¹¼ëŸ¼ íŒ¨ë°€ë¦¬ë¥¼ ì—¬ëŸ¬ ê°œë¡œ ìƒì„±í•´ì„œ íŠ¹ì§•ì´ ìœ ì‚¬í•œ ì¹¼ëŸ¼ë“¤ì„ ê·¸ë£¨í•‘í•´ì„œ ë°ì´í„°ë¥¼ ê´€ë¦¬í•  ìˆ˜ë„ ìˆìŒ</li>
</ul>

<p><br /></p>

<ul>
  <li>í‘œì‹œëœ ë°ì´í„° ì¤‘ íŠ¹ì • ë¡œìš°í‚¤ í•˜ë‚˜ë¥¼ ì„ íƒí•´ì„œ scan ëª…ë ¹ì˜ ì¡°ê±´ì ˆ ì¶”ê°€í•´ë³´ê¸°
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scan <span class="s1">'DriverCarInfo'</span>, <span class="o">{</span><span class="nv">STARTROW</span><span class="o">=&gt;</span><span class="s1">'00012230106102-X0005'</span>, <span class="nv">LIMIT</span><span class="o">=&gt;</span>1<span class="o">}</span>
</code></pre></div>    </div>
    <p><img src="img/CH05/scan%20%EC%A1%B0%EA%B1%B4%EC%A0%88%20%EC%B6%94%EA%B0%80.png" alt="" /></p>
  </li>
  <li><strong>car_number</strong>: X0005 -&gt; ìŠ¤ë§ˆíŠ¸ì¹´ ì°¨ëŸ‰ ë²ˆí˜¸ê°€ X0005ì¸ ìš´ì „ìì˜</li>
  <li><strong>date</strong>: 20160103221000 -&gt; 2016ë…„ 1ì›” 3ì¼ 22ì‹œ 10ë¶„ 00ì´ˆ ìš´í–‰ ì •ë³´ëŠ”</li>
  <li><strong>speed</strong>: 20 -&gt; ì‹œì† 20km/hë¡œ ì£¼í–‰</li>
  <li><strong>speed_pedal</strong>: 0 -&gt; ê°€ì† í˜ë‹¬ì„ ë°Ÿì§€ ì•Šì€ ìƒíƒœ</li>
  <li><strong>steer_angle</strong>: F -&gt; í•¸ë“¤ì€ ì§ì§„ ì¤‘</li>
  <li><strong>break_pedal</strong>: 1 -&gt; ë¸Œë ˆì´í¬ í˜ë‹¬ì„ 1ë‹¨ê³„ ì§„í–‰</li>
  <li><strong>direct_light</strong>: N -&gt; ê¹œë°•ì´ëŠ” ì¼œì§€ ì•Šì€ ìƒíƒœ</li>
  <li><strong>area_number</strong>: D01 -&gt; D01 ì§€ì—­ì„ ìš´í–‰</li>
</ul>

<p><br /></p>

<ul>
  <li>2016ë…„ 1ì›” 3ì¼ E08 ì§€ì—­ì„ ìš´í–‰í–ˆë˜ ëª¨ë“  ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ìì˜ ì°¨ëŸ‰ë²ˆí˜¸ì™€ ì§€ì—­ë²ˆí˜¸ ì¶œë ¥</li>
  <li>ë‚ ì§œ ì¡°ê±´ ì´ìš© ë°©ë²•) í…Œì´ë¸”ì˜ íƒ€ì„ìŠ¤íƒ¬í”„ ì´ìš© / ë‚ ì§œ í•„ë“œ ì§ì ‘ ì´ìš© / <strong>ë¡œìš°í‚¤ì— í¬í•¨ëœ ë‚ ì§œ ì •ë³´ ì´ìš©</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scan <span class="s1">'DriverCarInfo'</span>, <span class="o">{</span><span class="nv">COLUMNS</span><span class="o">=&gt;[</span><span class="s1">'c1:car_number'</span>, <span class="s1">'cf1:area_number'</span><span class="o">]</span>, <span class="nv">FILTER</span><span class="o">=&gt;</span><span class="s2">"RowFilter(=, 'regexstring:30106102') AND SingleColumnValueFilter('cf1', 'area_number', =, 'regexstring:E08')"</span><span class="o">}</span>
</code></pre></div>    </div>
    <p><img src="img/CH05/scan%20%EC%A1%B0%EA%B1%B4%EC%A0%882.png" alt="" /></p>
  </li>
</ul>

<blockquote>
  <p>hbase&gt; scan â€˜table ì´ë¦„â€™, {COLUMNS=&gt;[â€˜íŒ¨ë°€ë¦¬ì´ë¦„:ì»¬ëŸ¼ì´ë¦„â€™, â€˜íŒ¨ë°€ë¦¬ì´ë¦„:ì»¬ëŸ¼ì´ë¦„â€™], FILTER=&gt;â€ROWFILTER(=, â€˜regexstring:30106102â€™) AND SingleCloumnValueFilter(â€˜cf1â€™, â€˜area_numberâ€™, =, â€˜regexstring:E08â€™)â€} <br />
COLUMNS: ì¡°íšŒí•  ì»¬ëŸ¼ ì„ íƒ <br />
FILTER: ì´ìš©í•  í•„í„° <br />
ROWFILTER: Row Keyì—ì„œ ë¶€ë¶„ë¬¸ìì—´ ì¡°íšŒ -&gt; row keyì— â€˜30106102â€™ê°€ í¬í•¨ëœ ë°ì´í„°ë§Œ ì¡°íšŒ <br />
SingleColumnValueFilter: value ê¸°ë°˜ìœ¼ë¡œ ë§¤ì¹­í•˜ì—¬ cell ë°˜í™˜ -&gt; area_numberê°€ E08ì¸ ë°ì´í„°ë§Œ ì¡°íšŒ</p>
</blockquote>

<p><br /></p>

<ul>
  <li>HBase ì›¹ê´€ë¦¬ìì— ì ‘ì†í•´ì„œ ì ì¬í•œ ë°ì´í„°ê°€ ì•ì„œ ì‹¤í–‰í–ˆë˜ <code class="language-plaintext highlighter-rouge">Pre-Split</code> ëª…ë ¹ì— ì˜í•´ 2ê°œì˜ HRegionServerë¡œ ê³¨ê³ ë£¨ ë¶„ì‚° ì ì¬ëëŠ”ì§€ í™•ì¸ <br />
http://server02.hadoop.com:16010/</li>
</ul>

<p><br /></p>

<h3 id="3-ë ˆë””ìŠ¤ì—-ì ì¬ëœ-ë°ì´í„°-í™•ì¸">3) ë ˆë””ìŠ¤ì— ì ì¬ëœ ë°ì´í„° í™•ì¸</h3>
<ul>
  <li>ë ˆë””ìŠ¤ì—ëŠ” ìŠ¤ë§ˆíŠ¸ì¹´ ìš´ì „ì ì¤‘ ê³¼ì†í•œ ì°¨ëŸ‰ì˜ ì •ë³´ ë“¤ì–´ìˆìŒ</li>
  <li>ìŠ¤í†°ì˜ ì—ìŠ¤í¼ Boltì—ì„œ ì—ìŠ¤í¼ì˜ EPLì„ ì´ìš©í•´ ì¼ìë³„ë¡œ ê³¼ì†í•œ ìŠ¤ë§ˆíŠ¸ì¹´ë¥¼ ì°¾ì•„ë‚´ëŠ” ê¸°ëŠ¥ êµ¬í˜„í–ˆìŒ</li>
  <li><strong>ë ˆë””ìŠ¤ CLIì˜ <code class="language-plaintext highlighter-rouge">smembers</code> ëª…ë ¹ì„ í†µí•´ ì‹¤ì‹œê°„ ê³¼ì† ì°¨ëŸ‰ ì •ë³´ í™•ì¸</strong></li>
  <li>ì•„ë˜ì™€ ê°™ì´ server02ì—ì„œ <strong>201601013</strong>ì„ í‚¤ë¡œ set ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ì ì¬ë˜ì–´ìˆëŠ” ê³¼ì† ì°¨ëŸ‰ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>redis-cli
<span class="o">&gt;</span> smembers 20160103
</code></pre></div>    </div>
    <p><img src="img/CH05/redis_%EA%B3%BC%EC%86%8D%ED%95%9C%20%EC%9A%B4%EC%A0%84%EC%9E%90%20-%20%EB%82%A0%EC%A7%9C%EB%A1%9C%20%EC%A1%B0%ED%9A%8C.png" alt="" /></p>
  </li>
  <li>3ëŒ€ì˜ ìŠ¤ë§ˆíŠ¸ì¹´ ì°¨ëŸ‰ì´ ê³¼ì†í•œ ê²ƒì„ ê°ì§€</li>
</ul>

<p><br /></p>

<h3 id="4-ë ˆë””ìŠ¤-í´ë¼ì´ì–¸íŠ¸-ì• í”Œë¦¬ì¼€ì´ì…˜-ì‘ë™">4) ë ˆë””ìŠ¤ í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‘ë™</h3>
<ul>
  <li>ë ˆë””ìŠ¤ í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë ˆë””ìŠ¤ë¡œë¶€í„° 2016ë…„ 1ì›” 3ì¼ì— ë°œìƒë˜ëŠ” ê³¼ì† ì°¨ëŸ‰ ì •ë³´ë¥¼ 10ì´ˆ ê°„ê²©ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” í”„ë¡œê·¸ë¨</li>
  <li>íŒŒì¼ì§ˆë¼ë¡œ bigdata.smartcar.redis-1.0.jar íŒŒì¼ì„ server02ì˜ /home/pilot-pjt/working ë””ë ‰í„°ë¦¬ì— ì—…ë¡œë“œ</li>
</ul>

<p><br /></p>

<ul>
  <li>server02ì— ì ‘ì†í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /home/pilot-pjt/working
java <span class="nt">-cp</span> bigdata.smartcar.redis-1.0.jar com.wikibook.bigdata.smartcar.redis.OverSpeedCarInfo 20160103
</code></pre></div>    </div>
    <p><img src="img/CH05/redis%20%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8%20%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%20%EC%9E%91%EB%8F%99.png" alt="" /></p>
  </li>
  <li>ì°¨ëŸ‰ë²ˆí˜¸ â€˜X0005â€™, â€˜W0010â€™ë²ˆì— í•´ë‹¹í•˜ëŠ” ìŠ¤ë§ˆíŠ¸ì¹´ ë‘ ëŒ€ê°€ ê°ê° â€˜2016ë…„ 1ì›” 3ì¼ 22ì‹œ 25ë¶„ 12ì´ˆâ€™, â€˜2016ë…„ 1ì›” 3ì¼ 23ì¼ 54ë¶„ 28ì´ˆâ€™, â€˜2016ë…„ 1ì›” 3ì¼ 22ì‹œ 14ë¶„ 56ì´ˆâ€™ì— ê³¼ì† ìœ„ë°˜ ì°¨ëŸ‰ìœ¼ë¡œ ë°œê²¬ë¨</li>
  <li>10ì´ˆ ë’¤ì¸ [Try No.2]ì—ì„œëŠ” ê³¼ì† ì°¨ëŸ‰ì´ ë°œê²¬ë˜ì§€ ì•ŠìŒ</li>
  <li>í•´ë‹¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê³„ì† ì‹¤í–‰í•´ë‘ë©´ ìŠ¤í†° ë° ì—ìŠ¤í¼ì—ì„œ ë°œê²¬í•œ ê³¼ì† ì°¨ëŸ‰ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•´ì„œ ë ˆë””ìŠ¤ë¡œë¶€í„° ê°€ì ¸ì˜¤ê²Œ ë¨</li>
</ul>

<p><br /></p>

<ul>
  <li>ë¡œê·¸ ì‹œë®¬ë ˆì´í„° ì¢…ë£Œ
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ps <span class="nt">-ef</span> | <span class="nb">grep </span>smartcar.log
<span class="nb">kill</span> <span class="nt">-9</span> <span class="o">[</span>pid] <span class="o">[</span>pid]
</code></pre></div>    </div>
  </li>
</ul>

<p><br /></p>

<h3 id="5-ì‹¤ì‹œê°„-ê°œë°œ-í™˜ê²½-êµ¬ì„±">5) ì‹¤ì‹œê°„ ê°œë°œ í™˜ê²½ êµ¬ì„±</h3>
<ul>
  <li>íŒŒì¼ëŸ¿ í”„ë¡œì íŠ¸ì˜ í”„ë¡œê·¸ë¨ ê°œë°œ í™˜ê²½ êµ¬ì„±</li>
  <li>[ì´í´ë¦½ìŠ¤] ì‹¤í–‰ - C://ì˜ˆì œì†ŒìŠ¤/bigdata2nd-mastere/workspace/bigdata.smartcar.strom ê²½ë¡œ ì—´ê¸°</li>
  <li><strong>ë©”ì´ë¸(Maven)</strong> í”„ë¡œì íŠ¸ importë¨</li>
</ul>

<p><br /></p>

<ul>
  <li>com.wikibook.bigdata.smartcar.storm íŒ¨í‚¤ì§€ì˜ <strong>EsperBolt.java</strong> íŒŒì¼ ì„ íƒ</li>
  <li>37-44ë²ˆì§¸ ì¤„ì„ ë³´ë©´ ì—ìŠ¤í¼ì˜ EPL ì¿¼ë¦¬ ë³¼ ìˆ˜ ìˆìŒ</li>
  <li>SQLê³¼ ìœ ì‚¬í•˜ì§€ë§Œ, 42ë²ˆì§¸ ì¤„ì˜ From ì ˆì—ì„œ ì—ìŠ¤í¼ EPLë§Œì˜ ë…íŠ¹í•œ í•¨ìˆ˜ ë³¼ ìˆ˜ ìˆìŒ
<img src="img/CH05/esperbolt.java%20%EC%88%98%EC%A0%95.png" alt="" /></li>
  <li>EPL ì¿¼ë¦¬ë¥¼ ë³´ë©´ ì°¨ëŸ‰ë³€í˜¸ ë³„ë¡œ ê·¸ë£¨í•‘í•´ì„œ ìµœê·¼ 30ì´ˆ ë™ì•ˆ í‰ê·  ì†ë„ê°€ 80km/hë¥¼ ì´ˆê³¼í•œ ìš´ì „ìë¥¼ ì°¾ëŠ” ê²ƒ</li>
  <li><code class="language-plaintext highlighter-rouge">int avgOverSpeed</code> ë³€ìˆ˜ ê°’ì„ ìˆ˜ì •í•´ì„œ ê³¼ì† ê¸°ì¤€ ì†ë„ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŒ</li>
</ul>

<p><br /></p>

<ul>
  <li><strong>ë©”ì´ë¸ì˜ <code class="language-plaintext highlighter-rouge">install</code> ëª…ë ¹ì„ í†µí•´ ìˆ˜ì •í•œ ì†ŒìŠ¤ ë¹Œë“œí•˜ê³  íŒ¨í‚¹</strong></li>
  <li>[Package Explorer] - pom.xml íŒŒì¼ ì—´ê¸°</li>
  <li>ìƒë‹¨ ë©”ë‰´ì˜ [Run] - [Run As] - [Maven install] ë©”ë‰´ ì„ íƒ
<img src="img/CH05/maven_install%20%EC%8B%A4%ED%96%89.png" alt="" /></li>
  <li>ì•„ë˜ ì½˜ì†”ì°½ì—ì„œ <code class="language-plaintext highlighter-rouge">BUILD SUCCESS</code> ë©”ì‹œì§€ í™•ì¸
<img src="img/CH05/maven%20%EC%84%A4%EC%B9%98%EC%99%84%EB%A3%8C.png" alt="" /></li>
  <li>ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ëœ¬ë‹¤ë©´ í˜„ì¬ íŒŒì¼ëŸ¿ PCì— ë§ëŠ” ìë°” ëŸ°íƒ€ì„ í™˜ê²½ ì •ë³´ë¡œ ìˆ˜ì • í•„ìš”</li>
</ul>

<p><br /></p>

<ul>
  <li>ë¹Œë“œê°€ ëë‚˜ë©´ target ë””ë ‰í„°ë¦¬ ë°‘ì— bigdata.smartcar.strom-1.0.jar íŒŒì¼ì´ ìƒì„±ë  ê²ƒ -&gt; server02ì˜ /home/pilot-pjt/working ë””ë ‰í„°ë¦¬ì— ì—…ë¡œë“œ</li>
  <li>ìŠ¤í†° Topology ì¬ë°°í¬
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>storm <span class="nb">kill </span>DriverCarInfo
storm jar bigdata.smartcar.storm-1.0.jar com.wikibook.bigdata.smartcar.storm.SmartCarDriverTopology DriverCarInfo
</code></pre></div>    </div>
    <p><img src="img/CH05/storm%20topology%20%EC%9E%AC%EB%B0%B0%ED%8F%AC.png" alt="" /></p>
  </li>
</ul>
:ET